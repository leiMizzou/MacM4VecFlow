2025-03-16 19:42:22,334 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 19:42:22,334 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 19:42:22,426 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 19:42:22,426 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.1GB
2025-03-16 19:42:22,426 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 19:42:22,427 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 19:42:36,336 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 19:42:36,336 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 19:42:36,392 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 19:42:36,393 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.1GB
2025-03-16 19:42:36,393 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 19:42:36,393 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 19:42:37,301 - config - INFO - 启动协调器模式，时间: 2025-03-16 19:42:37
2025-03-16 19:42:37,301 - config - INFO - 启动协调器模式，时间: 2025-03-16 19:42:37
2025-03-16 19:42:37,301 - config - INFO - ================================================================================
2025-03-16 19:42:37,301 - config - INFO - ================================================================================
2025-03-16 19:42:37,301 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 19:42:37,301 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 19:42:37,301 - config - INFO - ================================================================================
2025-03-16 19:42:37,301 - config - INFO - ================================================================================
2025-03-16 19:42:37,301 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 19:42:37,301 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 19:42:37,301 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 19:42:37,301 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 19:42:37,301 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 19:42:37,301 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 19:42:37,301 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 19:42:37,301 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 19:42:37,301 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 19:42:37,301 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 19:42:37,301 - config - INFO - ✅ 系统优化完成
2025-03-16 19:42:37,301 - config - INFO - ✅ 系统优化完成
2025-03-16 19:42:37,305 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,305 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,305 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,305 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,306 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,306 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:42:37,306 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 19:42:37,306 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 19:42:37,306 - config - CRITICAL - 程序执行出现严重错误: cannot access local variable 'system_monitor' where it is not associated with a value
2025-03-16 19:42:37,306 - config - CRITICAL - 程序执行出现严重错误: cannot access local variable 'system_monitor' where it is not associated with a value
2025-03-16 19:42:37,306 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
    ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'system_monitor' where it is not associated with a value

2025-03-16 19:42:37,306 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
    ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'system_monitor' where it is not associated with a value

2025-03-16 19:42:37,306 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.01 秒)
2025-03-16 19:42:37,306 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.01 秒)
2025-03-16 19:42:37,306 - config - INFO - 完成时间: 2025-03-16 19:42:37
2025-03-16 19:42:37,306 - config - INFO - 完成时间: 2025-03-16 19:42:37
2025-03-16 19:47:59,533 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 19:47:59,533 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 19:47:59,590 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 19:47:59,590 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.1GB
2025-03-16 19:47:59,591 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 19:47:59,591 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 19:48:00,493 - config - INFO - 启动协调器模式，时间: 2025-03-16 19:48:00
2025-03-16 19:48:00,493 - config - INFO - 启动协调器模式，时间: 2025-03-16 19:48:00
2025-03-16 19:48:00,493 - config - INFO - ================================================================================
2025-03-16 19:48:00,493 - config - INFO - ================================================================================
2025-03-16 19:48:00,493 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 19:48:00,493 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 19:48:00,493 - config - INFO - ================================================================================
2025-03-16 19:48:00,493 - config - INFO - ================================================================================
2025-03-16 19:48:00,493 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 19:48:00,493 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 19:48:00,493 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 19:48:00,493 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 19:48:00,493 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 19:48:00,493 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 19:48:00,493 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 19:48:00,493 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 19:48:00,493 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 19:48:00,493 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 19:48:00,493 - config - INFO - ✅ 系统优化完成
2025-03-16 19:48:00,493 - config - INFO - ✅ 系统优化完成
2025-03-16 19:48:00,494 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,494 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,494 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,494 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,495 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,495 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 19:48:00,495 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 19:48:00,495 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 19:48:00,495 - config - CRITICAL - 程序执行出现严重错误: cannot access local variable 'system_monitor' where it is not associated with a value
2025-03-16 19:48:00,495 - config - CRITICAL - 程序执行出现严重错误: cannot access local variable 'system_monitor' where it is not associated with a value
2025-03-16 19:48:00,495 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
    ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'system_monitor' where it is not associated with a value

2025-03-16 19:48:00,495 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
    ^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'system_monitor' where it is not associated with a value

2025-03-16 19:48:00,495 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 19:48:00,495 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 19:48:00,495 - config - INFO - 完成时间: 2025-03-16 19:48:00
2025-03-16 19:48:00,495 - config - INFO - 完成时间: 2025-03-16 19:48:00
2025-03-16 20:13:25,642 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:13:25,642 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:13:25,712 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:13:25,712 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.5GB
2025-03-16 20:13:25,712 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:13:25,712 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:13:28,486 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:13:30,532 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:13:30
2025-03-16 20:13:30,532 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:13:30
2025-03-16 20:13:30,532 - config - INFO - ================================================================================
2025-03-16 20:13:30,532 - config - INFO - ================================================================================
2025-03-16 20:13:30,532 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:13:30,532 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:13:30,532 - config - INFO - ================================================================================
2025-03-16 20:13:30,532 - config - INFO - ================================================================================
2025-03-16 20:13:30,532 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:13:30,532 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:13:30,532 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:13:30,532 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:13:30,532 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:13:30,532 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:13:30,532 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:13:30,532 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:13:30,532 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:13:30,532 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:13:30,532 - config - INFO - ✅ 系统优化完成
2025-03-16 20:13:30,532 - config - INFO - ✅ 系统优化完成
2025-03-16 20:13:30,574 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,574 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,575 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,575 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,576 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,576 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:13:30,576 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:13:30,576 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:13:30,576 - config - CRITICAL - 程序执行出现严重错误: local variable 'system_monitor' referenced before assignment
2025-03-16 20:13:30,576 - config - CRITICAL - 程序执行出现严重错误: local variable 'system_monitor' referenced before assignment
2025-03-16 20:13:30,576 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
UnboundLocalError: local variable 'system_monitor' referenced before assignment

2025-03-16 20:13:30,576 - config - CRITICAL - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/main.py", line 74, in main
    run_coordinator(args)
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 779, in run_coordinator
    system_monitor.stop()
UnboundLocalError: local variable 'system_monitor' referenced before assignment

2025-03-16 20:13:30,576 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.04 秒)
2025-03-16 20:13:30,576 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.04 秒)
2025-03-16 20:13:30,576 - config - INFO - 完成时间: 2025-03-16 20:13:30
2025-03-16 20:13:30,576 - config - INFO - 完成时间: 2025-03-16 20:13:30
2025-03-16 20:18:43,810 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:18:43,810 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:18:43,868 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:18:43,868 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.1GB
2025-03-16 20:18:43,868 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:18:43,868 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:18:44,791 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:18:45,111 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:18:45
2025-03-16 20:18:45,111 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:18:45
2025-03-16 20:18:45,111 - config - INFO - ================================================================================
2025-03-16 20:18:45,111 - config - INFO - ================================================================================
2025-03-16 20:18:45,111 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:18:45,111 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:18:45,111 - config - INFO - ================================================================================
2025-03-16 20:18:45,111 - config - INFO - ================================================================================
2025-03-16 20:18:45,112 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:18:45,112 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:18:45,112 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:18:45,112 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:18:45,112 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:18:45,112 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:18:45,112 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:18:45,112 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:18:45,112 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:18:45,112 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:18:45,112 - config - INFO - ✅ 系统优化完成
2025-03-16 20:18:45,112 - config - INFO - ✅ 系统优化完成
2025-03-16 20:18:45,112 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:18:45,112 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:18:45,143 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,143 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,143 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,143 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,144 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,144 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:18:45,144 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:18:45,144 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:18:45,144 - config - INFO - 系统监控已停止
2025-03-16 20:18:45,144 - config - INFO - 系统监控已停止
2025-03-16 20:18:45,144 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.03 秒)
2025-03-16 20:18:45,144 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.03 秒)
2025-03-16 20:18:45,144 - config - INFO - 完成时间: 2025-03-16 20:18:45
2025-03-16 20:18:45,144 - config - INFO - 完成时间: 2025-03-16 20:18:45
2025-03-16 20:19:08,205 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:19:08,205 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:19:08,261 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:19:08,261 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.2GB
2025-03-16 20:19:08,261 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:19:08,261 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:19:09,194 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:19:09,512 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:09
2025-03-16 20:19:09,512 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:09
2025-03-16 20:19:09,512 - config - INFO - ================================================================================
2025-03-16 20:19:09,512 - config - INFO - ================================================================================
2025-03-16 20:19:09,512 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:09,512 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:09,512 - config - INFO - ================================================================================
2025-03-16 20:19:09,512 - config - INFO - ================================================================================
2025-03-16 20:19:09,512 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:09,512 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:09,512 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:09,512 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:09,513 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:09,513 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:09,513 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:09,513 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:09,513 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:09,513 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:09,513 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:09,513 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:09,513 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:09,513 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:14,545 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2025-03-16 20:19:14,545 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

2025-03-16 20:19:14,548 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:14,548 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:14,549 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:14,549 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:14,550 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:14,550 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:14,550 - config - INFO - 系统监控已停止
2025-03-16 20:19:14,550 - config - INFO - 系统监控已停止
2025-03-16 20:19:14,550 - config - INFO - 程序运行结束，总耗时: 0.08 分钟 (5.04 秒)
2025-03-16 20:19:14,550 - config - INFO - 程序运行结束，总耗时: 0.08 分钟 (5.04 秒)
2025-03-16 20:19:14,550 - config - INFO - 完成时间: 2025-03-16 20:19:14
2025-03-16 20:19:14,550 - config - INFO - 完成时间: 2025-03-16 20:19:14
2025-03-16 20:19:31,677 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:19:31,677 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:19:31,733 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:19:31,733 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.3GB
2025-03-16 20:19:31,733 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:19:31,733 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:19:32,679 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:19:32,996 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:32
2025-03-16 20:19:32,996 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:32
2025-03-16 20:19:32,996 - config - INFO - ================================================================================
2025-03-16 20:19:32,996 - config - INFO - ================================================================================
2025-03-16 20:19:32,996 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:32,996 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:32,996 - config - INFO - ================================================================================
2025-03-16 20:19:32,996 - config - INFO - ================================================================================
2025-03-16 20:19:32,996 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:32,996 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:32,996 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:32,996 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:32,996 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:32,996 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:32,996 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:32,996 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:32,996 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:32,996 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:32,997 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:32,997 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:32,997 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:32,997 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:33,030 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,030 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,031 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,031 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,032 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,032 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:33,032 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:33,032 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:33,032 - config - INFO - 系统监控已停止
2025-03-16 20:19:33,032 - config - INFO - 系统监控已停止
2025-03-16 20:19:33,032 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.04 秒)
2025-03-16 20:19:33,032 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.04 秒)
2025-03-16 20:19:33,032 - config - INFO - 完成时间: 2025-03-16 20:19:33
2025-03-16 20:19:33,032 - config - INFO - 完成时间: 2025-03-16 20:19:33
2025-03-16 20:19:36,866 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:19:36,866 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:19:36,921 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:19:36,921 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.3GB
2025-03-16 20:19:36,921 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:19:36,921 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:19:37,872 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:19:38,188 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:38
2025-03-16 20:19:38,188 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:38
2025-03-16 20:19:38,188 - config - INFO - ================================================================================
2025-03-16 20:19:38,188 - config - INFO - ================================================================================
2025-03-16 20:19:38,188 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:38,188 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:38,188 - config - INFO - ================================================================================
2025-03-16 20:19:38,188 - config - INFO - ================================================================================
2025-03-16 20:19:38,188 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:38,188 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:38,188 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:38,188 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:38,188 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:38,188 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:38,188 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:38,188 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:38,188 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:38,188 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:38,188 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:38,188 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:38,188 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:38,188 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:38,190 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,190 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,190 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,190 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,191 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,191 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:38,191 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:38,191 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:38,191 - config - INFO - 系统监控已停止
2025-03-16 20:19:38,191 - config - INFO - 系统监控已停止
2025-03-16 20:19:38,191 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 20:19:38,191 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 20:19:38,191 - config - INFO - 完成时间: 2025-03-16 20:19:38
2025-03-16 20:19:38,191 - config - INFO - 完成时间: 2025-03-16 20:19:38
2025-03-16 20:19:41,886 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 20:19:41,887 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 20:19:41,942 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 20:19:41,942 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.3GB
2025-03-16 20:19:41,943 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 20:19:41,943 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 20:19:42,879 - numexpr.utils - INFO - NumExpr defaulting to 10 threads.
2025-03-16 20:19:43,199 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:43
2025-03-16 20:19:43,199 - config - INFO - 启动协调器模式，时间: 2025-03-16 20:19:43
2025-03-16 20:19:43,199 - config - INFO - ================================================================================
2025-03-16 20:19:43,199 - config - INFO - ================================================================================
2025-03-16 20:19:43,199 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:43,199 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 20:19:43,199 - config - INFO - ================================================================================
2025-03-16 20:19:43,199 - config - INFO - ================================================================================
2025-03-16 20:19:43,199 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:43,199 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 20:19:43,199 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:43,199 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 20:19:43,199 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:43,199 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 20:19:43,199 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:43,199 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 20:19:43,199 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:43,199 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 20:19:43,199 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:43,199 - config - INFO - ✅ 系统优化完成
2025-03-16 20:19:43,199 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:43,199 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 20:19:43,201 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 数据库连接池初始化失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 普通数据库连接也失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 数据库连接失败: connection to server at "192.168.2.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

2025-03-16 20:19:43,201 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:43,201 - config - ERROR - 无法连接到数据库，程序退出
2025-03-16 20:19:43,202 - config - INFO - 系统监控已停止
2025-03-16 20:19:43,202 - config - INFO - 系统监控已停止
2025-03-16 20:19:43,202 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 20:19:43,202 - config - INFO - 程序运行结束，总耗时: 0.00 分钟 (0.00 秒)
2025-03-16 20:19:43,202 - config - INFO - 完成时间: 2025-03-16 20:19:43
2025-03-16 20:19:43,202 - config - INFO - 完成时间: 2025-03-16 20:19:43
2025-03-16 21:34:14,964 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:34:14,964 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:34:15,018 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:34:15,018 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:34:15,018 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:34:15,018 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:34:15,953 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:34:15
2025-03-16 21:34:15,953 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:34:15
2025-03-16 21:34:15,953 - config - INFO - ================================================================================
2025-03-16 21:34:15,953 - config - INFO - ================================================================================
2025-03-16 21:34:15,953 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:34:15,953 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:34:15,953 - config - INFO - ================================================================================
2025-03-16 21:34:15,953 - config - INFO - ================================================================================
2025-03-16 21:34:15,953 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:34:15,953 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:34:15,953 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:34:15,953 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:34:15,953 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:34:15,953 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:34:15,953 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:34:15,953 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:34:15,953 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:34:15,953 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:34:15,953 - config - INFO - ✅ 系统优化完成
2025-03-16 21:34:15,953 - config - INFO - ✅ 系统优化完成
2025-03-16 21:34:15,953 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:34:15,953 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:34:15,975 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:34:15,975 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:34:15,984 - config - INFO - 数据库连接成功
2025-03-16 21:34:15,984 - config - INFO - 数据库连接成功
2025-03-16 21:34:15,986 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:34:15,986 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:34:15,988 - config - INFO - device schema 已存在
2025-03-16 21:34:15,988 - config - INFO - device schema 已存在
2025-03-16 21:34:15,991 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:34:15,991 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:34:15,991 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:34:15,991 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:34:15,991 - config - INFO - ================================================================================
2025-03-16 21:34:15,991 - config - INFO - ================================================================================
2025-03-16 21:34:15,991 - config - INFO - 开始分布式数据处理...
2025-03-16 21:34:15,991 - config - INFO - 开始分布式数据处理...
2025-03-16 21:34:15,991 - config - INFO - ================================================================================
2025-03-16 21:34:15,991 - config - INFO - ================================================================================
2025-03-16 21:34:16,006 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:34:16,006 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:34:16,007 - config - INFO - 📊 优化配置:
2025-03-16 21:34:16,007 - config - INFO - 📊 优化配置:
2025-03-16 21:34:16,007 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:34:16,007 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:34:16,007 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:34:16,007 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:34:16,007 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:34:16,007 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:34:16,007 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:34:16,007 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:34:16,007 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:34:16,007 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:34:16,007 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:34:16,007 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:34:16,007 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:34:16,007 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:34:17,009 - config - ERROR - 程序执行过程中出错: Logger._log() got an unexpected keyword argument 'end'
2025-03-16 21:34:17,009 - config - ERROR - 程序执行过程中出错: Logger._log() got an unexpected keyword argument 'end'
2025-03-16 21:34:17,013 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 439, in run_coordinator
    logger.info(".", end="")
  File "/opt/anaconda3/lib/python3.12/logging/__init__.py", line 1539, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'end'

2025-03-16 21:34:17,013 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/coordinator_node.py", line 439, in run_coordinator
    logger.info(".", end="")
  File "/opt/anaconda3/lib/python3.12/logging/__init__.py", line 1539, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'end'

2025-03-16 21:34:17,013 - config - INFO - 系统监控已停止
2025-03-16 21:34:17,013 - config - INFO - 系统监控已停止
2025-03-16 21:34:17,014 - config - INFO - 数据库连接已关闭
2025-03-16 21:34:17,014 - config - INFO - 数据库连接已关闭
2025-03-16 21:34:17,014 - config - INFO - 数据库连接池已关闭
2025-03-16 21:34:17,014 - config - INFO - 数据库连接池已关闭
2025-03-16 21:34:17,015 - config - INFO - 通信资源已释放
2025-03-16 21:34:17,015 - config - INFO - 通信资源已释放
2025-03-16 21:34:17,015 - config - INFO - 程序运行结束，总耗时: 0.02 分钟 (1.06 秒)
2025-03-16 21:34:17,015 - config - INFO - 程序运行结束，总耗时: 0.02 分钟 (1.06 秒)
2025-03-16 21:34:17,015 - config - INFO - 完成时间: 2025-03-16 21:34:17
2025-03-16 21:34:17,015 - config - INFO - 完成时间: 2025-03-16 21:34:17
2025-03-16 21:37:27,947 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:37:27,947 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:37:28,004 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:37:28,004 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:37:28,004 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:37:28,004 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:37:28,925 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:37:28
2025-03-16 21:37:28,925 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:37:28
2025-03-16 21:37:28,925 - config - INFO - ================================================================================
2025-03-16 21:37:28,925 - config - INFO - ================================================================================
2025-03-16 21:37:28,925 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:37:28,925 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:37:28,925 - config - INFO - ================================================================================
2025-03-16 21:37:28,925 - config - INFO - ================================================================================
2025-03-16 21:37:28,925 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:37:28,925 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:37:28,925 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:37:28,925 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:37:28,925 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:37:28,925 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:37:28,925 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:37:28,925 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:37:28,925 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:37:28,925 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:37:28,925 - config - INFO - ✅ 系统优化完成
2025-03-16 21:37:28,925 - config - INFO - ✅ 系统优化完成
2025-03-16 21:37:28,925 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:37:28,925 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:37:28,949 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:37:28,949 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:37:28,958 - config - INFO - 数据库连接成功
2025-03-16 21:37:28,958 - config - INFO - 数据库连接成功
2025-03-16 21:37:28,960 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:37:28,960 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:37:28,962 - config - INFO - device schema 已存在
2025-03-16 21:37:28,962 - config - INFO - device schema 已存在
2025-03-16 21:37:28,965 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:37:28,965 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:37:28,965 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:37:28,965 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:37:28,965 - config - INFO - ================================================================================
2025-03-16 21:37:28,965 - config - INFO - ================================================================================
2025-03-16 21:37:28,965 - config - INFO - 开始分布式数据处理...
2025-03-16 21:37:28,965 - config - INFO - 开始分布式数据处理...
2025-03-16 21:37:28,965 - config - INFO - ================================================================================
2025-03-16 21:37:28,965 - config - INFO - ================================================================================
2025-03-16 21:37:28,979 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:37:28,979 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:37:28,979 - config - INFO - 📊 优化配置:
2025-03-16 21:37:28,979 - config - INFO - 📊 优化配置:
2025-03-16 21:37:28,979 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:37:28,979 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:37:28,979 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:37:28,979 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:37:28,979 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:37:28,979 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:37:28,979 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:37:28,979 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:37:28,979 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:37:28,979 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:37:28,979 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:37:28,979 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:37:28,979 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:37:28,979 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:37:39,006 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:37:39,006 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:37:39,114 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:37:39,114 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:37:39,115 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:37:39,115 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:37:39,115 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:37:39,115 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:37:39,115 - config - INFO - 启动文本切分线程...
2025-03-16 21:37:39,115 - config - INFO - 启动文本切分线程...
2025-03-16 21:37:39,546 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:37:39,546 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:37:39,592 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:37:39,592 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:37:39,596 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:37:39,596 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:37:39,596 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:37:39,596 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:37:39,597 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:37:39,597 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:37:39,598 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 514, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:37:39,598 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 514, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:37:39,599 - config - INFO - 所有文本切分任务完成
2025-03-16 21:37:39,599 - config - INFO - 所有文本切分任务完成
2025-03-16 21:37:40,121 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:37:40,121 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:37:40,121 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:37:40,121 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:37:40,121 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:37:40,121 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:37:40,122 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:37:41,126 - config - INFO - 启动数据库存储线程...
2025-03-16 21:37:41,126 - config - INFO - 启动数据库存储线程...
2025-03-16 21:37:44,395 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:37:44,395 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:37:44,396 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:37:44,396 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:37:44,484 - config - INFO - ✅ 模型预热完成
2025-03-16 21:37:44,484 - config - INFO - ✅ 模型预热完成
2025-03-16 21:37:44,839 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:37:44,839 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:37:44,839 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:37:44,839 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:37:44,839 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:37:44,839 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:37:44,840 - config - INFO - 系统监控已停止
2025-03-16 21:37:44,840 - config - INFO - 系统监控已停止
2025-03-16 21:37:45,008 - config - INFO - 所有向量存储任务完成，共存储 0 个向量
2025-03-16 21:37:45,008 - config - INFO - 所有向量存储任务完成，共存储 0 个向量
2025-03-16 21:38:00,614 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:38:00,614 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:38:00,614 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 等待 EmbeddingProcessor 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 等待 EmbeddingProcessor 线程完成...
2025-03-16 21:38:00,614 - config - INFO - 
处理完成:
2025-03-16 21:38:00,614 - config - INFO - 
处理完成:
2025-03-16 21:38:00,614 - config - INFO - ================================================================================
2025-03-16 21:38:00,614 - config - INFO - ================================================================================
2025-03-16 21:38:00,615 - config - INFO - 总耗时: 31.65 秒 (0.53 分钟)
2025-03-16 21:38:00,615 - config - INFO - 总耗时: 31.65 秒 (0.53 分钟)
2025-03-16 21:38:00,615 - config - INFO - 使用的设备: MPS
2025-03-16 21:38:00,615 - config - INFO - 使用的设备: MPS
2025-03-16 21:38:00,615 - config - INFO - 文本切分进程数: 8
2025-03-16 21:38:00,615 - config - INFO - 文本切分进程数: 8
2025-03-16 21:38:00,615 - config - INFO - 嵌入计算进程数: 1
2025-03-16 21:38:00,615 - config - INFO - 嵌入计算进程数: 1
2025-03-16 21:38:00,615 - config - INFO - 批处理大小: 512
2025-03-16 21:38:00,615 - config - INFO - 批处理大小: 512
2025-03-16 21:38:00,615 - config - INFO - ================================================================================
2025-03-16 21:38:00,615 - config - INFO - ================================================================================
2025-03-16 21:38:00,615 - config - INFO - 系统监控已停止
2025-03-16 21:38:00,615 - config - INFO - 系统监控已停止
2025-03-16 21:38:00,616 - config - INFO - 数据库连接已关闭
2025-03-16 21:38:00,616 - config - INFO - 数据库连接已关闭
2025-03-16 21:38:00,616 - config - INFO - 数据库连接池已关闭
2025-03-16 21:38:00,616 - config - INFO - 数据库连接池已关闭
2025-03-16 21:38:00,616 - config - INFO - 通信资源已释放
2025-03-16 21:38:00,616 - config - INFO - 通信资源已释放
2025-03-16 21:38:00,617 - config - INFO - 程序运行结束，总耗时: 0.53 分钟 (31.69 秒)
2025-03-16 21:38:00,617 - config - INFO - 程序运行结束，总耗时: 0.53 分钟 (31.69 秒)
2025-03-16 21:38:00,617 - config - INFO - 完成时间: 2025-03-16 21:38:00
2025-03-16 21:38:00,617 - config - INFO - 完成时间: 2025-03-16 21:38:00
2025-03-16 21:42:09,973 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:42:09,974 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:42:10,027 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:42:10,027 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:42:10,027 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:42:10,027 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:42:10,949 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:42:10
2025-03-16 21:42:10,949 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:42:10
2025-03-16 21:42:10,949 - config - INFO - ================================================================================
2025-03-16 21:42:10,949 - config - INFO - ================================================================================
2025-03-16 21:42:10,949 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:42:10,949 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:42:10,949 - config - INFO - ================================================================================
2025-03-16 21:42:10,949 - config - INFO - ================================================================================
2025-03-16 21:42:10,949 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:42:10,949 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:42:10,949 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:42:10,949 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:42:10,949 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:42:10,949 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:42:10,949 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:42:10,949 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:42:10,949 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:42:10,949 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:42:10,949 - config - INFO - ✅ 系统优化完成
2025-03-16 21:42:10,949 - config - INFO - ✅ 系统优化完成
2025-03-16 21:42:10,949 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:42:10,949 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:42:10,974 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:42:10,974 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:42:10,982 - config - INFO - 数据库连接成功
2025-03-16 21:42:10,982 - config - INFO - 数据库连接成功
2025-03-16 21:42:10,986 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:42:10,986 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:42:10,989 - config - INFO - device schema 已存在
2025-03-16 21:42:10,989 - config - INFO - device schema 已存在
2025-03-16 21:42:10,994 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:42:10,994 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:42:10,995 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:42:10,995 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:42:10,995 - config - INFO - ================================================================================
2025-03-16 21:42:10,995 - config - INFO - ================================================================================
2025-03-16 21:42:10,995 - config - INFO - 开始分布式数据处理...
2025-03-16 21:42:10,995 - config - INFO - 开始分布式数据处理...
2025-03-16 21:42:10,995 - config - INFO - ================================================================================
2025-03-16 21:42:10,995 - config - INFO - ================================================================================
2025-03-16 21:42:11,009 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:42:11,009 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:42:11,009 - config - INFO - 📊 优化配置:
2025-03-16 21:42:11,009 - config - INFO - 📊 优化配置:
2025-03-16 21:42:11,009 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:42:11,009 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:42:11,009 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:42:11,009 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:42:11,009 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:42:11,009 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:42:11,009 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:42:11,009 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:42:11,009 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:42:11,009 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:42:11,009 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:42:11,009 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:42:11,009 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:42:11,009 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:42:21,029 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:42:21,029 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:42:21,142 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:42:21,142 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:42:21,142 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:42:21,142 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:42:21,143 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:42:21,143 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:42:21,143 - config - INFO - 启动文本切分线程...
2025-03-16 21:42:21,143 - config - INFO - 启动文本切分线程...
2025-03-16 21:42:21,522 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:42:21,522 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:42:21,567 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:42:21,567 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:42:21,569 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:42:21,569 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:42:21,570 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:42:21,570 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:42:21,570 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:42:21,570 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:42:21,571 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 514, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:42:21,571 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 481, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 514, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:42:21,572 - config - INFO - 所有文本切分任务完成
2025-03-16 21:42:21,572 - config - INFO - 所有文本切分任务完成
2025-03-16 21:42:22,148 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:42:22,148 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:42:22,148 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:42:22,148 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:42:22,148 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:42:22,148 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:42:22,149 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:42:23,154 - config - INFO - 启动数据库存储线程...
2025-03-16 21:42:23,154 - config - INFO - 启动数据库存储线程...
2025-03-16 21:42:25,905 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:42:25,905 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:42:25,905 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:42:25,905 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:42:25,906 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:42:25,906 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:42:26,066 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:42:26,066 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:42:26,066 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:42:26,066 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:42:26,154 - config - INFO - ✅ 模型预热完成
2025-03-16 21:42:26,154 - config - INFO - ✅ 模型预热完成
2025-03-16 21:42:26,486 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:42:26,486 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:42:26,486 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:42:26,486 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:42:26,486 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:42:26,486 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:42:26,486 - config - INFO - 系统监控已停止
2025-03-16 21:42:26,486 - config - INFO - 系统监控已停止
2025-03-16 21:42:26,624 - config - INFO - 所有向量存储任务完成，共存储 0 个向量
2025-03-16 21:42:26,624 - config - INFO - 所有向量存储任务完成，共存储 0 个向量
2025-03-16 21:42:26,624 - config - INFO - 等待 EmbeddingProcessor 线程完成...
2025-03-16 21:42:26,624 - config - INFO - 等待 EmbeddingProcessor 线程完成...
2025-03-16 21:42:26,624 - config - INFO - 
处理完成:
2025-03-16 21:42:26,624 - config - INFO - 
处理完成:
2025-03-16 21:42:26,624 - config - INFO - ================================================================================
2025-03-16 21:42:26,624 - config - INFO - ================================================================================
2025-03-16 21:42:26,625 - config - INFO - 总耗时: 15.63 秒 (0.26 分钟)
2025-03-16 21:42:26,625 - config - INFO - 总耗时: 15.63 秒 (0.26 分钟)
2025-03-16 21:42:26,625 - config - INFO - 使用的设备: MPS
2025-03-16 21:42:26,625 - config - INFO - 使用的设备: MPS
2025-03-16 21:42:26,625 - config - INFO - 文本切分进程数: 8
2025-03-16 21:42:26,625 - config - INFO - 文本切分进程数: 8
2025-03-16 21:42:26,625 - config - INFO - 嵌入计算进程数: 1
2025-03-16 21:42:26,625 - config - INFO - 嵌入计算进程数: 1
2025-03-16 21:42:26,625 - config - INFO - 批处理大小: 512
2025-03-16 21:42:26,625 - config - INFO - 批处理大小: 512
2025-03-16 21:42:26,625 - config - INFO - ================================================================================
2025-03-16 21:42:26,625 - config - INFO - ================================================================================
2025-03-16 21:42:26,625 - config - INFO - 系统监控已停止
2025-03-16 21:42:26,625 - config - INFO - 系统监控已停止
2025-03-16 21:42:26,625 - config - INFO - 数据库连接已关闭
2025-03-16 21:42:26,625 - config - INFO - 数据库连接已关闭
2025-03-16 21:42:26,625 - config - INFO - 数据库连接池已关闭
2025-03-16 21:42:26,625 - config - INFO - 数据库连接池已关闭
2025-03-16 21:42:26,625 - config - INFO - 通信资源已释放
2025-03-16 21:42:26,625 - config - INFO - 通信资源已释放
2025-03-16 21:42:26,625 - config - INFO - 程序运行结束，总耗时: 0.26 分钟 (15.68 秒)
2025-03-16 21:42:26,625 - config - INFO - 程序运行结束，总耗时: 0.26 分钟 (15.68 秒)
2025-03-16 21:42:26,625 - config - INFO - 完成时间: 2025-03-16 21:42:26
2025-03-16 21:42:26,625 - config - INFO - 完成时间: 2025-03-16 21:42:26
2025-03-16 21:43:33,289 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:43:33,289 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:43:33,342 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:43:33,342 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:43:33,342 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:43:33,342 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:43:34,268 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:43:34
2025-03-16 21:43:34,268 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:43:34
2025-03-16 21:43:34,268 - config - INFO - ================================================================================
2025-03-16 21:43:34,268 - config - INFO - ================================================================================
2025-03-16 21:43:34,268 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:43:34,268 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:43:34,268 - config - INFO - ================================================================================
2025-03-16 21:43:34,268 - config - INFO - ================================================================================
2025-03-16 21:43:34,268 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:43:34,268 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:43:34,268 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:43:34,268 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:43:34,268 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:43:34,268 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:43:34,268 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:43:34,268 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:43:34,268 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:43:34,268 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:43:34,268 - config - INFO - ✅ 系统优化完成
2025-03-16 21:43:34,268 - config - INFO - ✅ 系统优化完成
2025-03-16 21:43:34,268 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:43:34,268 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:43:34,292 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:43:34,292 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:43:34,301 - config - INFO - 数据库连接成功
2025-03-16 21:43:34,301 - config - INFO - 数据库连接成功
2025-03-16 21:43:34,304 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:43:34,304 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:43:34,306 - config - INFO - device schema 已存在
2025-03-16 21:43:34,306 - config - INFO - device schema 已存在
2025-03-16 21:43:34,309 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:43:34,309 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:43:34,310 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:43:34,310 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:43:34,310 - config - INFO - ================================================================================
2025-03-16 21:43:34,310 - config - INFO - ================================================================================
2025-03-16 21:43:34,310 - config - INFO - 开始分布式数据处理...
2025-03-16 21:43:34,310 - config - INFO - 开始分布式数据处理...
2025-03-16 21:43:34,310 - config - INFO - ================================================================================
2025-03-16 21:43:34,310 - config - INFO - ================================================================================
2025-03-16 21:43:34,324 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:43:34,324 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:43:34,324 - config - INFO - 📊 优化配置:
2025-03-16 21:43:34,324 - config - INFO - 📊 优化配置:
2025-03-16 21:43:34,324 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:43:34,324 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:43:34,324 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:43:34,324 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:43:34,324 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:43:34,324 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:43:34,324 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:43:34,324 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:43:34,324 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:43:34,324 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:43:34,324 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:43:34,324 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:43:34,324 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:43:34,324 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:43:44,343 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:43:44,343 - config - INFO - 
没有工作节点连接，将以单机模式运行
2025-03-16 21:43:44,467 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:43:44,467 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:43:44,468 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:43:44,468 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:43:44,468 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:43:44,468 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:43:44,469 - config - INFO - 启动文本切分线程...
2025-03-16 21:43:44,469 - config - INFO - 启动文本切分线程...
2025-03-16 21:43:44,846 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:43:44,846 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:43:44,890 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:43:44,890 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:43:44,892 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 478, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:43:44,892 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 478, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:43:44,893 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:43:44,893 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:43:44,893 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:43:44,893 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:43:44,894 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 478, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 511, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:43:44,894 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 478, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 511, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:43:44,895 - config - INFO - 所有文本切分任务完成
2025-03-16 21:43:44,895 - config - INFO - 所有文本切分任务完成
2025-03-16 21:43:45,471 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:43:45,471 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:43:45,472 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:43:45,472 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:43:45,472 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:43:45,472 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:43:45,472 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:43:46,477 - config - INFO - 启动数据库存储线程...
2025-03-16 21:43:46,477 - config - INFO - 启动数据库存储线程...
2025-03-16 21:43:49,692 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:43:49,692 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:43:49,692 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:43:49,692 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:43:49,693 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:43:49,693 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:43:49,854 - config - INFO - 系统监控已停止
2025-03-16 21:43:49,854 - config - INFO - 系统监控已停止
2025-03-16 21:43:49,855 - config - INFO - 数据库连接已关闭
2025-03-16 21:43:49,855 - config - INFO - 数据库连接已关闭
2025-03-16 21:43:49,855 - config - INFO - 数据库连接池已关闭
2025-03-16 21:43:49,855 - config - INFO - 数据库连接池已关闭
2025-03-16 21:43:49,855 - config - INFO - 通信资源已释放
2025-03-16 21:43:49,855 - config - INFO - 通信资源已释放
2025-03-16 21:43:49,855 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:43:49,855 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:43:49,855 - config - INFO - 程序运行结束，总耗时: 0.26 分钟 (15.59 秒)
2025-03-16 21:43:49,855 - config - INFO - 程序运行结束，总耗时: 0.26 分钟 (15.59 秒)
2025-03-16 21:43:49,855 - config - INFO - 完成时间: 2025-03-16 21:43:49
2025-03-16 21:43:49,855 - config - INFO - 完成时间: 2025-03-16 21:43:49
2025-03-16 21:45:57,470 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:45:57,470 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:45:57,523 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:45:57,523 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:45:57,523 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:45:57,523 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:45:58,452 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:45:58
2025-03-16 21:45:58,452 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:45:58
2025-03-16 21:45:58,453 - config - INFO - ================================================================================
2025-03-16 21:45:58,453 - config - INFO - ================================================================================
2025-03-16 21:45:58,453 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:45:58,453 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:45:58,453 - config - INFO - ================================================================================
2025-03-16 21:45:58,453 - config - INFO - ================================================================================
2025-03-16 21:45:58,453 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:45:58,453 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:45:58,453 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:45:58,453 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:45:58,453 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:45:58,453 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:45:58,453 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:45:58,453 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:45:58,453 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:45:58,453 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:45:58,453 - config - INFO - ✅ 系统优化完成
2025-03-16 21:45:58,453 - config - INFO - ✅ 系统优化完成
2025-03-16 21:45:58,453 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:45:58,453 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:45:58,477 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:45:58,477 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:45:58,485 - config - INFO - 数据库连接成功
2025-03-16 21:45:58,485 - config - INFO - 数据库连接成功
2025-03-16 21:45:58,488 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:45:58,488 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:45:58,491 - config - INFO - device schema 已存在
2025-03-16 21:45:58,491 - config - INFO - device schema 已存在
2025-03-16 21:45:58,495 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:45:58,495 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:45:58,496 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:45:58,496 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:45:58,496 - config - INFO - ================================================================================
2025-03-16 21:45:58,496 - config - INFO - ================================================================================
2025-03-16 21:45:58,496 - config - INFO - 开始分布式数据处理...
2025-03-16 21:45:58,496 - config - INFO - 开始分布式数据处理...
2025-03-16 21:45:58,496 - config - INFO - ================================================================================
2025-03-16 21:45:58,496 - config - INFO - ================================================================================
2025-03-16 21:45:58,510 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:45:58,510 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:45:58,510 - config - INFO - 📊 优化配置:
2025-03-16 21:45:58,510 - config - INFO - 📊 优化配置:
2025-03-16 21:45:58,511 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:45:58,511 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:45:58,511 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:45:58,511 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:45:58,511 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:45:58,511 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:45:58,511 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:45:58,511 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:45:58,511 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:45:58,511 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:45:58,511 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:45:58,511 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:45:58,511 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:45:58,511 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:46:08,536 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 21:46:08,536 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 21:46:08,649 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:46:08,649 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:46:08,651 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:46:08,651 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:46:08,651 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:46:08,651 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:46:08,651 - config - INFO - 启动文本切分线程...
2025-03-16 21:46:08,651 - config - INFO - 启动文本切分线程...
2025-03-16 21:46:09,029 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:46:09,029 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:46:09,073 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:46:09,073 - config - ERROR - 分区数据获取出错: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^

2025-03-16 21:46:09,076 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 434, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:46:09,076 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 434, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


2025-03-16 21:46:09,076 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:46:09,076 - config - INFO - 尝试使用备用查询方法...
2025-03-16 21:46:09,077 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:46:09,077 - config - ERROR - 备用查询方法也失败: current transaction is aborted, commands ignored until end of transaction block

2025-03-16 21:46:09,078 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 434, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 467, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:46:09,078 - config - ERROR - Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 434, in fetch_partitioned_data
    cur.execute("""
psycopg2.errors.UndefinedColumn: column "text_field" does not exist
LINE 2:                             SELECT report_number, text_field
                                                          ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/lei/Documents/GitHub/MacM4VecFlow/main/db_processor.py", line 467, in fetch_partitioned_data
    cur.execute(total_query, (limit,))
psycopg2.errors.InFailedSqlTransaction: current transaction is aborted, commands ignored until end of transaction block


2025-03-16 21:46:09,078 - config - INFO - 所有文本切分任务完成
2025-03-16 21:46:09,078 - config - INFO - 所有文本切分任务完成
2025-03-16 21:46:09,656 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:46:09,656 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:46:09,657 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:46:09,657 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:46:09,657 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:46:09,657 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:46:09,659 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:46:10,659 - config - INFO - 启动数据库存储线程...
2025-03-16 21:46:10,659 - config - INFO - 启动数据库存储线程...
2025-03-16 21:46:11,830 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:46:11,830 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:46:11,830 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:46:11,830 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:46:11,830 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:46:11,830 - config - INFO - 等待 DBConsumer 线程完成...
2025-03-16 21:46:11,998 - config - INFO - 系统监控已停止
2025-03-16 21:46:11,998 - config - INFO - 系统监控已停止
2025-03-16 21:46:11,999 - config - INFO - 数据库连接已关闭
2025-03-16 21:46:11,999 - config - INFO - 数据库连接已关闭
2025-03-16 21:46:11,999 - config - INFO - 数据库连接池已关闭
2025-03-16 21:46:11,999 - config - INFO - 数据库连接池已关闭
2025-03-16 21:46:11,999 - config - INFO - 通信资源已释放
2025-03-16 21:46:11,999 - config - INFO - 通信资源已释放
2025-03-16 21:46:12,000 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:46:12,000 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:46:12,000 - config - INFO - 程序运行结束，总耗时: 0.23 分钟 (13.55 秒)
2025-03-16 21:46:12,000 - config - INFO - 程序运行结束，总耗时: 0.23 分钟 (13.55 秒)
2025-03-16 21:46:12,000 - config - INFO - 完成时间: 2025-03-16 21:46:12
2025-03-16 21:46:12,000 - config - INFO - 完成时间: 2025-03-16 21:46:12
2025-03-16 21:51:47,534 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:51:47,534 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:51:47,590 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:51:47,591 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:51:47,591 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:51:47,591 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:51:48,519 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:51:48
2025-03-16 21:51:48,519 - config - INFO - 启动协调器模式，时间: 2025-03-16 21:51:48
2025-03-16 21:51:48,519 - config - INFO - ================================================================================
2025-03-16 21:51:48,519 - config - INFO - ================================================================================
2025-03-16 21:51:48,519 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:51:48,519 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 21:51:48,520 - config - INFO - ================================================================================
2025-03-16 21:51:48,520 - config - INFO - ================================================================================
2025-03-16 21:51:48,520 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:51:48,520 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 21:51:48,520 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:51:48,520 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 21:51:48,520 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:51:48,520 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 21:51:48,520 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:51:48,520 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 21:51:48,520 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:51:48,520 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 21:51:48,520 - config - INFO - ✅ 系统优化完成
2025-03-16 21:51:48,520 - config - INFO - ✅ 系统优化完成
2025-03-16 21:51:48,520 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:51:48,520 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:51:48,543 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:51:48,543 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 21:51:48,551 - config - INFO - 数据库连接成功
2025-03-16 21:51:48,551 - config - INFO - 数据库连接成功
2025-03-16 21:51:48,554 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:51:48,554 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 21:51:48,558 - config - INFO - device schema 已存在
2025-03-16 21:51:48,558 - config - INFO - device schema 已存在
2025-03-16 21:51:48,561 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:51:48,561 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 21:51:48,562 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:51:48,562 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 21:51:48,562 - config - INFO - ================================================================================
2025-03-16 21:51:48,562 - config - INFO - ================================================================================
2025-03-16 21:51:48,562 - config - INFO - 开始分布式数据处理...
2025-03-16 21:51:48,562 - config - INFO - 开始分布式数据处理...
2025-03-16 21:51:48,562 - config - INFO - ================================================================================
2025-03-16 21:51:48,562 - config - INFO - ================================================================================
2025-03-16 21:51:48,577 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:51:48,577 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 21:51:48,577 - config - INFO - 📊 优化配置:
2025-03-16 21:51:48,577 - config - INFO - 📊 优化配置:
2025-03-16 21:51:48,577 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:51:48,577 - config - INFO -   → 文本切分进程数: 8
2025-03-16 21:51:48,577 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:51:48,577 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 21:51:48,577 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:51:48,577 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 21:51:48,577 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:51:48,577 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 21:51:48,577 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:51:48,577 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 21:51:48,577 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:51:48,577 - config - INFO -   → 结果队列大小: 10000
2025-03-16 21:51:48,577 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:51:48,577 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 21:51:58,607 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 21:51:58,607 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 21:51:58,715 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:51:58,715 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 21:51:58,715 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:51:58,715 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 21:51:58,715 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:51:58,715 - config - INFO - 启动分布式流水线处理...
2025-03-16 21:51:58,716 - config - INFO - 启动文本切分线程...
2025-03-16 21:51:58,716 - config - INFO - 启动文本切分线程...
2025-03-16 21:51:59,086 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:51:59,086 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 21:51:59,147 - config - INFO - 批次 1: 处理 10000 条记录
2025-03-16 21:51:59,147 - config - INFO - 批次 1: 处理 10000 条记录
2025-03-16 21:51:59,721 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:51:59,721 - config - INFO - 启动嵌入处理线程...
2025-03-16 21:51:59,722 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:51:59,722 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:51:59,722 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:51:59,722 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:51:59,722 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:00,649 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,650 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,668 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,668 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,677 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,678 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,704 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,704 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,712 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,713 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,723 - config - INFO - 启动数据库存储线程...
2025-03-16 21:52:00,723 - config - INFO - 启动数据库存储线程...
2025-03-16 21:52:00,725 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,725 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,747 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,748 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,762 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:00,762 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:52:00,762 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:00,762 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:00,767 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 21:52:00,767 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 21:52:00,921 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:00,921 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:52:00,922 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:00,922 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:00,937 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:00,937 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 21:52:00,937 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:00,937 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:01,021 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:01,022 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.7GB
2025-03-16 21:52:01,022 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:01,022 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:01,028 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:01,028 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.7GB
2025-03-16 21:52:01,028 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:01,029 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:01,029 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:01,030 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.7GB
2025-03-16 21:52:01,030 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:01,030 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:01,042 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:01,042 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.8GB
2025-03-16 21:52:01,043 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:01,043 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:01,054 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 21:52:01,054 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 7.8GB
2025-03-16 21:52:01,054 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 21:52:01,054 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 21:52:02,833 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:02,833 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:02,834 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:02,998 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:02,999 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:02,999 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,035 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,035 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,035 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,089 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,089 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,090 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,123 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,123 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,123 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,131 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,131 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,132 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,132 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,132 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,132 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,164 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:03,164 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:03,164 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,926 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,926 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:03,926 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:03,926 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:04,045 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:04,045 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:04,407 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:04,407 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:04,407 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:04,407 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:04,407 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:52:04,407 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 21:52:06,982 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:06,982 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:07,004 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:07,004 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:07,076 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:07,092 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:07,419 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:07,420 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:07,425 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:07,426 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:07,691 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:07,692 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:07,776 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:07,777 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:07,882 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:07,952 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:07,954 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:08,030 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:08,033 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:08,047 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:08,164 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:08,166 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:08,252 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:08,255 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:08,255 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:08,262 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:08,306 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,306 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:08,325 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:08,392 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,392 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:08,395 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:08,584 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,584 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:08,605 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,605 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:08,664 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,665 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:08,733 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:08,733 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:10,587 - config - INFO -   → 成功存储 1 个向量，总计: 1，耗时 0.02秒
2025-03-16 21:52:10,587 - config - INFO -   → 成功存储 1 个向量，总计: 1，耗时 0.02秒
2025-03-16 21:52:11,394 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:11,394 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:12,278 - config - INFO -   → 成功存储 551 个向量，总计: 552，耗时 0.13秒
2025-03-16 21:52:12,278 - config - INFO -   → 成功存储 551 个向量，总计: 552，耗时 0.13秒
2025-03-16 21:52:12,944 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:12,944 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:13,649 - config - INFO -   → 成功存储 528 个向量，总计: 1080，耗时 0.12秒
2025-03-16 21:52:13,649 - config - INFO -   → 成功存储 528 个向量，总计: 1080，耗时 0.12秒
2025-03-16 21:52:14,450 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:14,450 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:15,025 - config - INFO -   → 成功存储 513 个向量，总计: 1593，耗时 0.12秒
2025-03-16 21:52:15,025 - config - INFO -   → 成功存储 513 个向量，总计: 1593，耗时 0.12秒
2025-03-16 21:52:16,008 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:16,008 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:16,397 - config - INFO -   → 成功存储 521 个向量，总计: 2114，耗时 0.12秒
2025-03-16 21:52:16,397 - config - INFO -   → 成功存储 521 个向量，总计: 2114，耗时 0.12秒
2025-03-16 21:52:17,738 - config - INFO -   → 成功存储 516 个向量，总计: 2630，耗时 0.12秒
2025-03-16 21:52:17,738 - config - INFO -   → 成功存储 516 个向量，总计: 2630，耗时 0.12秒
2025-03-16 21:52:18,426 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:18,426 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:19,106 - config - INFO -   → 成功存储 525 个向量，总计: 3155，耗时 0.12秒
2025-03-16 21:52:19,106 - config - INFO -   → 成功存储 525 个向量，总计: 3155，耗时 0.12秒
2025-03-16 21:52:19,934 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:19,934 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:20,437 - config - INFO -   → 成功存储 520 个向量，总计: 3675，耗时 0.12秒
2025-03-16 21:52:20,437 - config - INFO -   → 成功存储 520 个向量，总计: 3675，耗时 0.12秒
2025-03-16 21:52:21,446 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:21,446 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:21,791 - config - INFO -   → 成功存储 521 个向量，总计: 4196，耗时 0.11秒
2025-03-16 21:52:21,791 - config - INFO -   → 成功存储 521 个向量，总计: 4196，耗时 0.11秒
2025-03-16 21:52:23,154 - config - INFO -   → 成功存储 526 个向量，总计: 4722，耗时 0.11秒
2025-03-16 21:52:23,154 - config - INFO -   → 成功存储 526 个向量，总计: 4722，耗时 0.11秒
2025-03-16 21:52:23,845 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:23,845 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:24,613 - config - INFO -   → 成功存储 534 个向量，总计: 5256，耗时 0.11秒
2025-03-16 21:52:24,613 - config - INFO -   → 成功存储 534 个向量，总计: 5256，耗时 0.11秒
2025-03-16 21:52:25,369 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:25,369 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:25,974 - config - INFO -   → 成功存储 526 个向量，总计: 5782，耗时 0.11秒
2025-03-16 21:52:25,974 - config - INFO -   → 成功存储 526 个向量，总计: 5782，耗时 0.11秒
2025-03-16 21:52:26,913 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:26,913 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:27,299 - config - INFO -   → 成功存储 525 个向量，总计: 6307，耗时 0.11秒
2025-03-16 21:52:27,299 - config - INFO -   → 成功存储 525 个向量，总计: 6307，耗时 0.11秒
2025-03-16 21:52:28,643 - config - INFO -   → 成功存储 530 个向量，总计: 6837，耗时 0.11秒
2025-03-16 21:52:28,643 - config - INFO -   → 成功存储 530 个向量，总计: 6837，耗时 0.11秒
2025-03-16 21:52:29,330 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:29,330 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:29,992 - config - INFO -   → 成功存储 526 个向量，总计: 7363，耗时 0.11秒
2025-03-16 21:52:29,992 - config - INFO -   → 成功存储 526 个向量，总计: 7363，耗时 0.11秒
2025-03-16 21:52:30,838 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:30,838 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:31,335 - config - INFO -   → 成功存储 534 个向量，总计: 7897，耗时 0.12秒
2025-03-16 21:52:31,335 - config - INFO -   → 成功存储 534 个向量，总计: 7897，耗时 0.12秒
2025-03-16 21:52:31,343 - config - INFO -   → 批次 1 文本切分完成，耗时 32.20秒
2025-03-16 21:52:31,343 - config - INFO -   → 批次 1 文本切分完成，耗时 32.20秒
2025-03-16 21:52:31,344 - config - INFO - 
分区进度: 已处理 10000 条记录 (2.0%)
2025-03-16 21:52:31,344 - config - INFO - 
分区进度: 已处理 10000 条记录 (2.0%)
2025-03-16 21:52:31,344 - config - INFO -   → 已用时间: 0.7分钟，预计剩余: 34.9分钟
2025-03-16 21:52:31,344 - config - INFO -   → 已用时间: 0.7分钟，预计剩余: 34.9分钟
2025-03-16 21:52:31,344 - config - INFO -   → 已生成 13248 个文本块，队列大小: 4839
2025-03-16 21:52:31,344 - config - INFO -   → 已生成 13248 个文本块，队列大小: 4839
2025-03-16 21:52:31,427 - config - INFO - 批次 2: 处理 10000 条记录
2025-03-16 21:52:31,427 - config - INFO - 批次 2: 处理 10000 条记录
2025-03-16 21:52:31,435 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,435 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,435 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,436 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,436 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,437 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,437 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,437 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,438 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,438 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,438 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,439 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,439 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,440 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,441 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,441 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,441 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,442 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,442 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,442 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,442 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:31,443 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 21:52:31,443 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 21:52:31,444 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:32,726 - config - INFO -   → 成功存储 533 个向量，总计: 8430，耗时 0.11秒
2025-03-16 21:52:32,726 - config - INFO -   → 成功存储 533 个向量，总计: 8430，耗时 0.11秒
2025-03-16 21:52:34,150 - config - INFO -   → 成功存储 531 个向量，总计: 8961，耗时 0.12秒
2025-03-16 21:52:34,150 - config - INFO -   → 成功存储 531 个向量，总计: 8961，耗时 0.12秒
2025-03-16 21:52:35,454 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,455 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,455 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,454 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,455 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,455 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,455 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,455 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,462 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,462 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,473 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,473 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,476 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:35,476 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:35,481 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,481 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,483 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,483 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,483 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,492 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,492 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:35,707 - config - INFO -   → 成功存储 535 个向量，总计: 9496，耗时 0.13秒
2025-03-16 21:52:35,707 - config - INFO -   → 成功存储 535 个向量，总计: 9496，耗时 0.13秒
2025-03-16 21:52:35,944 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,945 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,950 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,949 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,951 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,950 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,953 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,953 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,957 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,958 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,958 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,964 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:35,974 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:35,979 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:36,179 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 21:52:36,181 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 21:52:36,274 - config - INFO - ✅ 模型预热完成
2025-03-16 21:52:36,675 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 21:52:36,675 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 21:52:37,307 - config - INFO -   → 已处理 10000 个嵌入向量 (304.0 个/秒), 队列中还有 2792 个文本块
2025-03-16 21:52:37,307 - config - INFO -   → 已处理 10000 个嵌入向量 (304.0 个/秒), 队列中还有 2792 个文本块
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19832, 批处理大小: 512
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19832, 批处理大小: 512
2025-03-16 21:52:37,308 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2791 个文本块
2025-03-16 21:52:37,308 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2791 个文本块
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19833, 批处理大小: 512
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19833, 批处理大小: 512
2025-03-16 21:52:37,308 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2790 个文本块
2025-03-16 21:52:37,308 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2790 个文本块
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19834, 批处理大小: 512
2025-03-16 21:52:37,308 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19834, 批处理大小: 512
2025-03-16 21:52:37,309 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2789 个文本块
2025-03-16 21:52:37,309 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2789 个文本块
2025-03-16 21:52:37,309 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19835, 批处理大小: 512
2025-03-16 21:52:37,309 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19835, 批处理大小: 512
2025-03-16 21:52:37,310 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2788 个文本块
2025-03-16 21:52:37,310 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2788 个文本块
2025-03-16 21:52:37,310 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19836, 批处理大小: 512
2025-03-16 21:52:37,310 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19836, 批处理大小: 512
2025-03-16 21:52:37,311 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2787 个文本块
2025-03-16 21:52:37,311 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2787 个文本块
2025-03-16 21:52:37,311 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19837, 批处理大小: 512
2025-03-16 21:52:37,311 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19837, 批处理大小: 512
2025-03-16 21:52:37,311 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2786 个文本块
2025-03-16 21:52:37,311 - config - INFO -   → 已处理 10000 个嵌入向量 (303.9 个/秒), 队列中还有 2786 个文本块
2025-03-16 21:52:37,312 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19838, 批处理大小: 512
2025-03-16 21:52:37,312 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19838, 批处理大小: 512
2025-03-16 21:52:37,318 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2785 个文本块
2025-03-16 21:52:37,318 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2785 个文本块
2025-03-16 21:52:37,318 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19839, 批处理大小: 512
2025-03-16 21:52:37,318 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19839, 批处理大小: 512
2025-03-16 21:52:37,319 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2784 个文本块
2025-03-16 21:52:37,319 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2784 个文本块
2025-03-16 21:52:37,319 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19840, 批处理大小: 512
2025-03-16 21:52:37,319 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19840, 批处理大小: 512
2025-03-16 21:52:37,320 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2783 个文本块
2025-03-16 21:52:37,320 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2783 个文本块
2025-03-16 21:52:37,321 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19841, 批处理大小: 512
2025-03-16 21:52:37,321 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19841, 批处理大小: 512
2025-03-16 21:52:37,322 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2782 个文本块
2025-03-16 21:52:37,322 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2782 个文本块
2025-03-16 21:52:37,322 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19842, 批处理大小: 512
2025-03-16 21:52:37,322 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19842, 批处理大小: 512
2025-03-16 21:52:37,324 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2781 个文本块
2025-03-16 21:52:37,324 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2781 个文本块
2025-03-16 21:52:37,324 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19843, 批处理大小: 512
2025-03-16 21:52:37,324 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19843, 批处理大小: 512
2025-03-16 21:52:37,325 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2780 个文本块
2025-03-16 21:52:37,325 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2780 个文本块
2025-03-16 21:52:37,325 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19844, 批处理大小: 512
2025-03-16 21:52:37,325 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19844, 批处理大小: 512
2025-03-16 21:52:37,326 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2779 个文本块
2025-03-16 21:52:37,326 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2779 个文本块
2025-03-16 21:52:37,326 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19845, 批处理大小: 512
2025-03-16 21:52:37,326 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19845, 批处理大小: 512
2025-03-16 21:52:37,327 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2778 个文本块
2025-03-16 21:52:37,327 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2778 个文本块
2025-03-16 21:52:37,327 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19846, 批处理大小: 512
2025-03-16 21:52:37,327 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19846, 批处理大小: 512
2025-03-16 21:52:37,328 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2777 个文本块
2025-03-16 21:52:37,328 - config - INFO -   → 已处理 10000 个嵌入向量 (303.8 个/秒), 队列中还有 2777 个文本块
2025-03-16 21:52:37,328 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19847, 批处理大小: 512
2025-03-16 21:52:37,328 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19847, 批处理大小: 512
2025-03-16 21:52:37,329 - config - INFO -   → 已处理 10000 个嵌入向量 (303.7 个/秒), 队列中还有 2776 个文本块
2025-03-16 21:52:37,329 - config - INFO -   → 已处理 10000 个嵌入向量 (303.7 个/秒), 队列中还有 2776 个文本块
2025-03-16 21:52:37,329 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19848, 批处理大小: 512
2025-03-16 21:52:37,329 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19848, 批处理大小: 512
2025-03-16 21:52:37,331 - config - INFO -   → 已处理 10000 个嵌入向量 (303.7 个/秒), 队列中还有 2775 个文本块
2025-03-16 21:52:37,331 - config - INFO -   → 已处理 10000 个嵌入向量 (303.7 个/秒), 队列中还有 2775 个文本块
2025-03-16 21:52:37,331 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19849, 批处理大小: 512
2025-03-16 21:52:37,331 - config - INFO -   → 缓存命中率: 1.5%, 命中/未命中: 312/19849, 批处理大小: 512
2025-03-16 21:52:37,740 - config - INFO -   → 成功存储 508 个向量，总计: 10004，耗时 0.19秒
2025-03-16 21:52:37,740 - config - INFO -   → 成功存储 508 个向量，总计: 10004，耗时 0.19秒
2025-03-16 21:52:38,912 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:38,912 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:39,308 - config - INFO -   → 成功存储 550 个向量，总计: 10554，耗时 0.12秒
2025-03-16 21:52:39,308 - config - INFO -   → 成功存储 550 个向量，总计: 10554，耗时 0.12秒
2025-03-16 21:52:40,763 - config - INFO -   → 成功存储 547 个向量，总计: 11101，耗时 0.11秒
2025-03-16 21:52:40,763 - config - INFO -   → 成功存储 547 个向量，总计: 11101，耗时 0.11秒
2025-03-16 21:52:41,455 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:41,455 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:42,173 - config - INFO -   → 成功存储 532 个向量，总计: 11633，耗时 0.11秒
2025-03-16 21:52:42,173 - config - INFO -   → 成功存储 532 个向量，总计: 11633，耗时 0.11秒
2025-03-16 21:52:42,966 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:42,966 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:43,554 - config - INFO -   → 成功存储 536 个向量，总计: 12169，耗时 0.12秒
2025-03-16 21:52:43,554 - config - INFO -   → 成功存储 536 个向量，总计: 12169，耗时 0.12秒
2025-03-16 21:52:44,479 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:44,479 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:44,997 - config - INFO -   → 成功存储 553 个向量，总计: 12722，耗时 0.15秒
2025-03-16 21:52:44,997 - config - INFO -   → 成功存储 553 个向量，总计: 12722，耗时 0.15秒
2025-03-16 21:52:45,995 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:45,995 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:46,375 - config - INFO -   → 成功存储 547 个向量，总计: 13269，耗时 0.11秒
2025-03-16 21:52:46,375 - config - INFO -   → 成功存储 547 个向量，总计: 13269，耗时 0.11秒
2025-03-16 21:52:47,770 - config - INFO -   → 成功存储 556 个向量，总计: 13825，耗时 0.11秒
2025-03-16 21:52:47,770 - config - INFO -   → 成功存储 556 个向量，总计: 13825，耗时 0.11秒
2025-03-16 21:52:48,460 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:48,460 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:49,193 - config - INFO -   → 成功存储 549 个向量，总计: 14374，耗时 0.12秒
2025-03-16 21:52:49,193 - config - INFO -   → 成功存储 549 个向量，总计: 14374，耗时 0.12秒
2025-03-16 21:52:49,970 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:49,970 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:50,548 - config - INFO -   → 成功存储 559 个向量，总计: 14933，耗时 0.12秒
2025-03-16 21:52:50,548 - config - INFO -   → 成功存储 559 个向量，总计: 14933，耗时 0.12秒
2025-03-16 21:52:51,521 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:51,521 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:51,921 - config - INFO -   → 成功存储 564 个向量，总计: 15497，耗时 0.12秒
2025-03-16 21:52:51,921 - config - INFO -   → 成功存储 564 个向量，总计: 15497，耗时 0.12秒
2025-03-16 21:52:53,370 - config - INFO -   → 成功存储 562 个向量，总计: 16059，耗时 0.12秒
2025-03-16 21:52:53,370 - config - INFO -   → 成功存储 562 个向量，总计: 16059，耗时 0.12秒
2025-03-16 21:52:54,056 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:54,056 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:54,706 - config - INFO -   → 成功存储 548 个向量，总计: 16607，耗时 0.12秒
2025-03-16 21:52:54,706 - config - INFO -   → 成功存储 548 个向量，总计: 16607，耗时 0.12秒
2025-03-16 21:52:55,567 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:55,567 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:56,126 - config - INFO -   → 成功存储 553 个向量，总计: 17160，耗时 0.11秒
2025-03-16 21:52:56,126 - config - INFO -   → 成功存储 553 个向量，总计: 17160，耗时 0.11秒
2025-03-16 21:52:57,084 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:57,084 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:57,552 - config - INFO -   → 成功存储 574 个向量，总计: 17734，耗时 0.13秒
2025-03-16 21:52:57,552 - config - INFO -   → 成功存储 574 个向量，总计: 17734，耗时 0.13秒
2025-03-16 21:52:58,876 - config - INFO -   → 成功存储 546 个向量，总计: 18280，耗时 0.12秒
2025-03-16 21:52:58,876 - config - INFO -   → 成功存储 546 个向量，总计: 18280，耗时 0.12秒
2025-03-16 21:52:58,936 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:52:58,936 - config - WARNING - 收到键盘中断，正在安全关闭...
2025-03-16 21:52:58,936 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:52:58,936 - config - INFO - 等待 ChunkProducer 线程完成...
2025-03-16 21:52:59,565 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:59,565 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 21:52:59,609 - config - INFO - 系统监控已停止
2025-03-16 21:52:59,609 - config - INFO - 系统监控已停止
2025-03-16 21:52:59,611 - config - INFO - 数据库连接已关闭
2025-03-16 21:52:59,611 - config - INFO - 数据库连接已关闭
2025-03-16 21:52:59,618 - config - INFO - 数据库连接池已关闭
2025-03-16 21:52:59,618 - config - INFO - 数据库连接池已关闭
2025-03-16 21:52:59,625 - config - INFO - 通信资源已释放
2025-03-16 21:52:59,625 - config - INFO - 通信资源已释放
2025-03-16 21:52:59,625 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:52:59,625 - config - WARNING - 收到中断信号，程序正在安全关闭...
2025-03-16 21:52:59,626 - config - INFO - 程序运行结束，总耗时: 1.19 分钟 (71.11 秒)
2025-03-16 21:52:59,626 - config - INFO - 程序运行结束，总耗时: 1.19 分钟 (71.11 秒)
2025-03-16 21:52:59,629 - config - INFO - 完成时间: 2025-03-16 21:52:59
2025-03-16 21:52:59,629 - config - INFO - 完成时间: 2025-03-16 21:52:59
2025-03-16 22:05:13,335 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:13,335 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:13,397 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:13,398 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:13,398 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:13,398 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:14,836 - config - INFO - 启动协调器模式，时间: 2025-03-16 22:05:14
2025-03-16 22:05:14,836 - config - INFO - 启动协调器模式，时间: 2025-03-16 22:05:14
2025-03-16 22:05:14,836 - config - INFO - ================================================================================
2025-03-16 22:05:14,836 - config - INFO - ================================================================================
2025-03-16 22:05:14,836 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 22:05:14,836 - config - INFO - 启动协调器节点，监听地址: 0.0.0.0:5555
2025-03-16 22:05:14,836 - config - INFO - ================================================================================
2025-03-16 22:05:14,836 - config - INFO - ================================================================================
2025-03-16 22:05:14,836 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 22:05:14,836 - config - INFO - 🔧 应用 M4 系统优化...
2025-03-16 22:05:14,836 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 22:05:14,836 - config - INFO -   ⚠️ 无法设置进程优先级
2025-03-16 22:05:14,836 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 22:05:14,836 - config - INFO -   ✓ NumPy 配置优化，使用 Accelerate 框架，最大线程: 10
2025-03-16 22:05:14,836 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 22:05:14,836 - config - INFO -   ✓ 内存分配器已优化
2025-03-16 22:05:14,836 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 22:05:14,836 - config - INFO -   ✓ 垃圾回收器已优化
2025-03-16 22:05:14,836 - config - INFO - ✅ 系统优化完成
2025-03-16 22:05:14,836 - config - INFO - ✅ 系统优化完成
2025-03-16 22:05:14,836 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 22:05:14,836 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 22:05:14,863 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 22:05:14,863 - config - INFO - 数据库连接池初始化成功 (min=2, max=10)
2025-03-16 22:05:14,871 - config - INFO - 数据库连接成功
2025-03-16 22:05:14,871 - config - INFO - 数据库连接成功
2025-03-16 22:05:14,873 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 22:05:14,873 - config - INFO - PostgreSQL 'vector' 扩展已安装
2025-03-16 22:05:14,876 - config - INFO - device schema 已存在
2025-03-16 22:05:14,876 - config - INFO - device schema 已存在
2025-03-16 22:05:14,879 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 22:05:14,879 - config - INFO - 向量表 device.event_text_vectors 创建成功
2025-03-16 22:05:14,879 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 22:05:14,879 - config - INFO - 协调器监听在端口 5555(workers) 和 5556(tasks)
2025-03-16 22:05:14,879 - config - INFO - ================================================================================
2025-03-16 22:05:14,879 - config - INFO - ================================================================================
2025-03-16 22:05:14,879 - config - INFO - 开始分布式数据处理...
2025-03-16 22:05:14,879 - config - INFO - 开始分布式数据处理...
2025-03-16 22:05:14,879 - config - INFO - ================================================================================
2025-03-16 22:05:14,879 - config - INFO - ================================================================================
2025-03-16 22:05:14,893 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 22:05:14,893 - config - INFO - 检测到M4芯片: Apple M4
2025-03-16 22:05:14,894 - config - INFO - 📊 优化配置:
2025-03-16 22:05:14,894 - config - INFO - 📊 优化配置:
2025-03-16 22:05:14,894 - config - INFO -   → 文本切分进程数: 8
2025-03-16 22:05:14,894 - config - INFO -   → 文本切分进程数: 8
2025-03-16 22:05:14,894 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 22:05:14,894 - config - INFO -   → 嵌入计算进程数: 2
2025-03-16 22:05:14,894 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 22:05:14,894 - config - INFO -   → 数据库连接池大小: 6
2025-03-16 22:05:14,894 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 22:05:14,894 - config - INFO -   → 嵌入批处理大小: 512
2025-03-16 22:05:14,894 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 22:05:14,894 - config - INFO -   → 文本块队列大小: 5000
2025-03-16 22:05:14,894 - config - INFO -   → 结果队列大小: 10000
2025-03-16 22:05:14,894 - config - INFO -   → 结果队列大小: 10000
2025-03-16 22:05:14,894 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 22:05:14,894 - config - INFO - 等待工作节点连接...(10秒超时)
2025-03-16 22:05:24,919 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 22:05:24,919 - config - INFO - 没有工作节点连接，将以单机模式运行
2025-03-16 22:05:25,033 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 22:05:25,033 - config - INFO - 总共需要处理约 500000 条记录

2025-03-16 22:05:25,034 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 22:05:25,034 - config - INFO - 系统监控已启动，无活动超时时间: 300秒
2025-03-16 22:05:25,035 - config - INFO - 启动分布式流水线处理...
2025-03-16 22:05:25,035 - config - INFO - 启动分布式流水线处理...
2025-03-16 22:05:25,035 - config - INFO - 启动文本切分线程...
2025-03-16 22:05:25,035 - config - INFO - 启动文本切分线程...
2025-03-16 22:05:25,423 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 22:05:25,423 - config - INFO - 分区 1/1: 处理行 1 到 500000 (共 500000 行)
2025-03-16 22:05:25,480 - config - INFO - 批次 1: 处理 10000 条记录
2025-03-16 22:05:25,480 - config - INFO - 批次 1: 处理 10000 条记录
2025-03-16 22:05:26,039 - config - INFO - 启动嵌入处理线程...
2025-03-16 22:05:26,039 - config - INFO - 启动嵌入处理线程...
2025-03-16 22:05:26,040 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:26,040 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:26,040 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:26,040 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:26,041 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:27,032 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,033 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,045 - config - INFO - 启动数据库存储线程...
2025-03-16 22:05:27,045 - config - INFO - 启动数据库存储线程...
2025-03-16 22:05:27,071 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,071 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,076 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,076 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,088 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,088 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,097 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,097 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,120 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,120 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,121 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,121 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,127 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,127 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,127 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,127 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,153 - config - INFO - ✅ 使用 Apple MPS (M4 GPU) 加速
2025-03-16 22:05:27,154 - config - INFO - 🚀 正在应用增强的MPS优化...
2025-03-16 22:05:27,283 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,283 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,283 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,283 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,335 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,335 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,335 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,335 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,399 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,399 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,399 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,399 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,408 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,408 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,408 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,409 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,420 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,421 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,421 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,421 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,421 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,421 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,421 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,421 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:27,427 - config - INFO -   ✓ MPS图形管道预热完成
2025-03-16 22:05:27,427 - config - INFO -   ✓ MPS内存优化配置完成，建议最大使用: 8.0GB
2025-03-16 22:05:27,427 - config - INFO -   ✓ MPS内存监视器已启动
2025-03-16 22:05:27,427 - config - INFO - ✓ PyTorch 线程配置: 5
2025-03-16 22:05:29,249 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,249 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,250 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,297 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,297 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,298 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,388 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,388 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,389 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,394 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,394 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,394 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,435 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,435 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,435 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,445 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,445 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,446 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,479 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,479 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,479 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:29,497 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:29,497 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:29,497 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:31,604 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:31,604 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:31,604 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:31,604 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:31,680 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:31,680 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:32,028 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:32,028 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:32,028 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:32,028 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:32,028 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 22:05:32,028 - config - INFO - 系统监控已启动，无活动超时时间: 180秒
2025-03-16 22:05:33,494 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:33,494 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:33,580 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:33,580 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:33,611 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:33,623 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:33,623 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:33,686 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:33,709 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:33,709 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:33,729 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:33,791 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:33,791 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:33,802 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:33,885 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:33,961 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:33,961 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,029 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:34,029 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:34,086 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,086 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,130 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:34,177 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,177 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,215 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,215 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,364 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:34,364 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:34,583 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,583 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,621 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:34,621 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:34,621 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:05:34,770 - config - INFO - ✅ 模型预热完成
2025-03-16 22:05:34,800 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,800 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:34,958 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:34,958 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:35,110 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:05:35,110 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:05:36,613 - config - INFO -   → 成功存储 1 个向量，总计: 1，耗时 0.02秒
2025-03-16 22:05:36,613 - config - INFO -   → 成功存储 1 个向量，总计: 1，耗时 0.02秒
2025-03-16 22:05:37,422 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:37,422 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:38,338 - config - INFO -   → 成功存储 551 个向量，总计: 552，耗时 0.12秒
2025-03-16 22:05:38,338 - config - INFO -   → 成功存储 551 个向量，总计: 552，耗时 0.12秒
2025-03-16 22:05:39,010 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:39,010 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:39,730 - config - INFO -   → 成功存储 528 个向量，总计: 1080，耗时 0.11秒
2025-03-16 22:05:39,730 - config - INFO -   → 成功存储 528 个向量，总计: 1080，耗时 0.11秒
2025-03-16 22:05:40,518 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:40,518 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:41,123 - config - INFO -   → 成功存储 513 个向量，总计: 1593，耗时 0.12秒
2025-03-16 22:05:41,123 - config - INFO -   → 成功存储 513 个向量，总计: 1593，耗时 0.12秒
2025-03-16 22:05:42,030 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:42,030 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:42,498 - config - INFO -   → 成功存储 521 个向量，总计: 2114，耗时 0.10秒
2025-03-16 22:05:42,498 - config - INFO -   → 成功存储 521 个向量，总计: 2114，耗时 0.10秒
2025-03-16 22:05:43,541 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:43,541 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:43,863 - config - INFO -   → 成功存储 516 个向量，总计: 2630，耗时 0.10秒
2025-03-16 22:05:43,863 - config - INFO -   → 成功存储 516 个向量，总计: 2630，耗时 0.10秒
2025-03-16 22:05:45,216 - config - INFO -   → 成功存储 525 个向量，总计: 3155，耗时 0.11秒
2025-03-16 22:05:45,216 - config - INFO -   → 成功存储 525 个向量，总计: 3155，耗时 0.11秒
2025-03-16 22:05:45,908 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:45,908 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:46,550 - config - INFO -   → 成功存储 520 个向量，总计: 3675，耗时 0.11秒
2025-03-16 22:05:46,550 - config - INFO -   → 成功存储 520 个向量，总计: 3675，耗时 0.11秒
2025-03-16 22:05:47,418 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:47,418 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:47,921 - config - INFO -   → 成功存储 521 个向量，总计: 4196，耗时 0.11秒
2025-03-16 22:05:47,921 - config - INFO -   → 成功存储 521 个向量，总计: 4196，耗时 0.11秒
2025-03-16 22:05:48,931 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:48,931 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:49,282 - config - INFO -   → 成功存储 526 个向量，总计: 4722，耗时 0.11秒
2025-03-16 22:05:49,282 - config - INFO -   → 成功存储 526 个向量，总计: 4722，耗时 0.11秒
2025-03-16 22:05:50,735 - config - INFO -   → 成功存储 534 个向量，总计: 5256，耗时 0.12秒
2025-03-16 22:05:50,735 - config - INFO -   → 成功存储 534 个向量，总计: 5256，耗时 0.12秒
2025-03-16 22:05:51,425 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:51,425 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:52,100 - config - INFO -   → 成功存储 526 个向量，总计: 5782，耗时 0.11秒
2025-03-16 22:05:52,100 - config - INFO -   → 成功存储 526 个向量，总计: 5782，耗时 0.11秒
2025-03-16 22:05:52,936 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:52,936 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:53,446 - config - INFO -   → 成功存储 525 个向量，总计: 6307，耗时 0.11秒
2025-03-16 22:05:53,446 - config - INFO -   → 成功存储 525 个向量，总计: 6307，耗时 0.11秒
2025-03-16 22:05:54,452 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:54,452 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:54,804 - config - INFO -   → 成功存储 530 个向量，总计: 6837，耗时 0.11秒
2025-03-16 22:05:54,804 - config - INFO -   → 成功存储 530 个向量，总计: 6837，耗时 0.11秒
2025-03-16 22:05:56,150 - config - INFO -   → 成功存储 526 个向量，总计: 7363，耗时 0.11秒
2025-03-16 22:05:56,150 - config - INFO -   → 成功存储 526 个向量，总计: 7363，耗时 0.11秒
2025-03-16 22:05:56,841 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:56,841 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:05:57,346 - config - INFO -   → 批次 1 文本切分完成，耗时 31.87秒
2025-03-16 22:05:57,346 - config - INFO -   → 批次 1 文本切分完成，耗时 31.87秒
2025-03-16 22:05:57,347 - config - INFO - 
分区进度: 已处理 10000 条记录 (2.0%)
2025-03-16 22:05:57,347 - config - INFO - 
分区进度: 已处理 10000 条记录 (2.0%)
2025-03-16 22:05:57,347 - config - INFO -   → 已用时间: 0.7分钟，预计剩余: 34.7分钟
2025-03-16 22:05:57,347 - config - INFO -   → 已用时间: 0.7分钟，预计剩余: 34.7分钟
2025-03-16 22:05:57,347 - config - INFO -   → 已生成 13248 个文本块，队列大小: 4839
2025-03-16 22:05:57,347 - config - INFO -   → 已生成 13248 个文本块，队列大小: 4839
2025-03-16 22:05:57,431 - config - INFO - 批次 2: 处理 10000 条记录
2025-03-16 22:05:57,431 - config - INFO - 批次 2: 处理 10000 条记录
2025-03-16 22:05:57,479 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,480 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,480 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,481 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,481 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,481 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,482 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,482 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,482 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,483 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,483 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,484 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,484 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,484 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,485 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,485 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,485 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,485 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,486 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,486 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,486 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,487 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:05:57,487 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:05:57,487 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:05:57,502 - config - INFO -   → 成功存储 534 个向量，总计: 7897，耗时 0.11秒
2025-03-16 22:05:57,502 - config - INFO -   → 成功存储 534 个向量，总计: 7897，耗时 0.11秒
2025-03-16 22:05:58,930 - config - INFO -   → 成功存储 533 个向量，总计: 8430，耗时 0.11秒
2025-03-16 22:05:58,930 - config - INFO -   → 成功存储 533 个向量，总计: 8430，耗时 0.11秒
2025-03-16 22:06:00,321 - config - INFO -   → 成功存储 531 个向量，总计: 8961，耗时 0.11秒
2025-03-16 22:06:00,321 - config - INFO -   → 成功存储 531 个向量，总计: 8961，耗时 0.11秒
2025-03-16 22:06:01,446 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:01,446 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:01,446 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:01,446 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:01,446 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:01,446 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:01,446 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:01,446 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:01,460 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:01,461 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:01,462 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:01,463 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:01,614 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:01,615 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:01,635 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:01,767 - config - INFO -   → 成功存储 541 个向量，总计: 9502，耗时 0.12秒
2025-03-16 22:06:01,767 - config - INFO -   → 成功存储 541 个向量，总计: 9502，耗时 0.12秒
2025-03-16 22:06:01,805 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:01,805 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:01,832 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:01,832 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:01,839 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:01,840 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:01,980 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:01,980 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:02,035 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:02,035 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:02,555 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:02,555 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:02,601 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:02,958 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:02,958 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:03,374 - config - INFO -   → 成功存储 544 个向量，总计: 10046，耗时 0.12秒
2025-03-16 22:06:03,374 - config - INFO -   → 成功存储 544 个向量，总计: 10046，耗时 0.12秒
2025-03-16 22:06:04,666 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:04,667 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:04,679 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:04,848 - config - INFO -   → 成功存储 549 个向量，总计: 10595，耗时 0.11秒
2025-03-16 22:06:04,848 - config - INFO -   → 成功存储 549 个向量，总计: 10595，耗时 0.11秒
2025-03-16 22:06:05,049 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:05,049 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:05,598 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:05,599 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:05,663 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:06,007 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:06,007 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:06,314 - config - INFO -   → 成功存储 548 个向量，总计: 11143，耗时 0.11秒
2025-03-16 22:06:06,314 - config - INFO -   → 成功存储 548 个向量，总计: 11143，耗时 0.11秒
2025-03-16 22:06:07,014 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:07,014 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:07,740 - config - INFO -   → 成功存储 536 个向量，总计: 11679，耗时 0.11秒
2025-03-16 22:06:07,740 - config - INFO -   → 成功存储 536 个向量，总计: 11679，耗时 0.11秒
2025-03-16 22:06:08,523 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:08,523 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:09,148 - config - INFO -   → 成功存储 533 个向量，总计: 12212，耗时 0.11秒
2025-03-16 22:06:09,148 - config - INFO -   → 成功存储 533 个向量，总计: 12212，耗时 0.11秒
2025-03-16 22:06:10,033 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:10,033 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:10,562 - config - INFO -   → 成功存储 553 个向量，总计: 12765，耗时 0.10秒
2025-03-16 22:06:10,562 - config - INFO -   → 成功存储 553 个向量，总计: 12765，耗时 0.10秒
2025-03-16 22:06:11,540 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:11,540 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:11,979 - config - INFO -   → 成功存储 548 个向量，总计: 13313，耗时 0.11秒
2025-03-16 22:06:11,979 - config - INFO -   → 成功存储 548 个向量，总计: 13313，耗时 0.11秒
2025-03-16 22:06:13,343 - config - INFO -   → 成功存储 554 个向量，总计: 13867，耗时 0.10秒
2025-03-16 22:06:13,343 - config - INFO -   → 成功存储 554 个向量，总计: 13867，耗时 0.10秒
2025-03-16 22:06:14,043 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:14,043 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:14,762 - config - INFO -   → 成功存储 555 个向量，总计: 14422，耗时 0.11秒
2025-03-16 22:06:14,762 - config - INFO -   → 成功存储 555 个向量，总计: 14422，耗时 0.11秒
2025-03-16 22:06:15,553 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:15,553 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:16,150 - config - INFO -   → 成功存储 558 个向量，总计: 14980，耗时 0.10秒
2025-03-16 22:06:16,150 - config - INFO -   → 成功存储 558 个向量，总计: 14980，耗时 0.10秒
2025-03-16 22:06:17,070 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:17,070 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:17,579 - config - INFO -   → 成功存储 567 个向量，总计: 15547，耗时 0.14秒
2025-03-16 22:06:17,579 - config - INFO -   → 成功存储 567 个向量，总计: 15547，耗时 0.14秒
2025-03-16 22:06:18,592 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:18,592 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:18,997 - config - INFO -   → 成功存储 553 个向量，总计: 16100，耗时 0.11秒
2025-03-16 22:06:18,997 - config - INFO -   → 成功存储 553 个向量，总计: 16100，耗时 0.11秒
2025-03-16 22:06:20,366 - config - INFO -   → 成功存储 556 个向量，总计: 16656，耗时 0.12秒
2025-03-16 22:06:20,366 - config - INFO -   → 成功存储 556 个向量，总计: 16656，耗时 0.12秒
2025-03-16 22:06:21,056 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:21,056 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:21,844 - config - INFO -   → 成功存储 557 个向量，总计: 17213，耗时 0.10秒
2025-03-16 22:06:21,844 - config - INFO -   → 成功存储 557 个向量，总计: 17213，耗时 0.10秒
2025-03-16 22:06:22,563 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:22,563 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:23,276 - config - INFO -   → 成功存储 565 个向量，总计: 17778，耗时 0.12秒
2025-03-16 22:06:23,276 - config - INFO -   → 成功存储 565 个向量，总计: 17778，耗时 0.12秒
2025-03-16 22:06:24,070 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:24,070 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:24,630 - config - INFO -   → 成功存储 548 个向量，总计: 18326，耗时 0.11秒
2025-03-16 22:06:24,630 - config - INFO -   → 成功存储 548 个向量，总计: 18326，耗时 0.11秒
2025-03-16 22:06:25,582 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:25,582 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:26,049 - config - INFO -   → 成功存储 561 个向量，总计: 18887，耗时 0.12秒
2025-03-16 22:06:26,049 - config - INFO -   → 成功存储 561 个向量，总计: 18887，耗时 0.12秒
2025-03-16 22:06:27,053 - config - INFO - 进度检查: 3/3 个线程活跃
2025-03-16 22:06:27,053 - config - INFO - 进度检查: 3/3 个线程活跃
2025-03-16 22:06:27,056 - config - INFO - 块队列大小: 5000, 结果队列大小: 0
2025-03-16 22:06:27,056 - config - INFO - 块队列大小: 5000, 结果队列大小: 0
2025-03-16 22:06:27,056 - config - INFO - 切分完成标志: False, 嵌入完成标志: False
2025-03-16 22:06:27,056 - config - INFO - 切分完成标志: False, 嵌入完成标志: False
2025-03-16 22:06:27,403 - config - INFO -   → 成功存储 571 个向量，总计: 19458，耗时 0.12秒
2025-03-16 22:06:27,403 - config - INFO -   → 成功存储 571 个向量，总计: 19458，耗时 0.12秒
2025-03-16 22:06:28,083 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:28,083 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4766 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4766 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38094, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38094, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4765 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4765 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38095, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38095, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4764 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4764 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38096, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38096, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4763 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4763 个文本块
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38097, 批处理大小: 512
2025-03-16 22:06:28,416 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38097, 批处理大小: 512
2025-03-16 22:06:28,417 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4762 个文本块
2025-03-16 22:06:28,417 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4762 个文本块
2025-03-16 22:06:28,417 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38098, 批处理大小: 512
2025-03-16 22:06:28,417 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38098, 批处理大小: 512
2025-03-16 22:06:28,417 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4761 个文本块
2025-03-16 22:06:28,417 - config - INFO -   → 已处理 20000 个嵌入向量 (354.7 个/秒), 队列中还有 4761 个文本块
2025-03-16 22:06:28,417 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38099, 批处理大小: 512
2025-03-16 22:06:28,417 - config - INFO -   → 缓存命中率: 2.7%, 命中/未命中: 1055/38099, 批处理大小: 512
2025-03-16 22:06:28,741 - config - INFO -   → 成功存储 566 个向量，总计: 20024，耗时 0.11秒
2025-03-16 22:06:28,741 - config - INFO -   → 成功存储 566 个向量，总计: 20024，耗时 0.11秒
2025-03-16 22:06:29,588 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:29,588 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:30,088 - config - INFO -   → 批次 2 文本切分完成，耗时 32.66秒
2025-03-16 22:06:30,088 - config - INFO -   → 批次 2 文本切分完成，耗时 32.66秒
2025-03-16 22:06:30,113 - config - INFO - 
分区进度: 已处理 20000 条记录 (4.0%)
2025-03-16 22:06:30,113 - config - INFO - 
分区进度: 已处理 20000 条记录 (4.0%)
2025-03-16 22:06:30,120 - config - INFO -   → 已用时间: 1.3分钟，预计剩余: 30.1分钟
2025-03-16 22:06:30,120 - config - INFO -   → 已用时间: 1.3分钟，预计剩余: 30.1分钟
2025-03-16 22:06:30,120 - config - INFO -   → 已生成 25843 个文本块，队列大小: 4755
2025-03-16 22:06:30,120 - config - INFO -   → 已生成 25843 个文本块，队列大小: 4755
2025-03-16 22:06:30,160 - config - INFO -   → 成功存储 552 个向量，总计: 20576，耗时 0.11秒
2025-03-16 22:06:30,160 - config - INFO -   → 成功存储 552 个向量，总计: 20576，耗时 0.11秒
2025-03-16 22:06:30,205 - config - INFO - 批次 3: 处理 10000 条记录
2025-03-16 22:06:30,205 - config - INFO - 批次 3: 处理 10000 条记录
2025-03-16 22:06:30,210 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,211 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,211 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,211 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,211 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,211 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,212 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,212 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,212 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,213 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,213 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,213 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,214 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,214 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,215 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,215 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,215 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,216 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,216 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,216 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,216 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:30,218 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:06:30,218 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:06:30,219 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:31,592 - config - INFO -   → 成功存储 571 个向量，总计: 21147，耗时 0.11秒
2025-03-16 22:06:31,592 - config - INFO -   → 成功存储 571 个向量，总计: 21147，耗时 0.11秒
2025-03-16 22:06:32,991 - config - INFO -   → 成功存储 556 个向量，总计: 21703，耗时 0.11秒
2025-03-16 22:06:32,991 - config - INFO -   → 成功存储 556 个向量，总计: 21703，耗时 0.11秒
2025-03-16 22:06:34,364 - config - INFO -   → 成功存储 555 个向量，总计: 22258，耗时 0.11秒
2025-03-16 22:06:34,364 - config - INFO -   → 成功存储 555 个向量，总计: 22258，耗时 0.11秒
2025-03-16 22:06:34,561 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:34,561 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:34,598 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:34,984 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:34,984 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:35,781 - config - INFO -   → 成功存储 570 个向量，总计: 22828，耗时 0.13秒
2025-03-16 22:06:35,781 - config - INFO -   → 成功存储 570 个向量，总计: 22828，耗时 0.13秒
2025-03-16 22:06:35,922 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:35,922 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:35,948 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:36,012 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:36,012 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:36,095 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:36,310 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:36,310 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:36,440 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:36,441 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:37,267 - config - INFO -   → 成功存储 552 个向量，总计: 23380，耗时 0.11秒
2025-03-16 22:06:37,267 - config - INFO -   → 成功存储 552 个向量，总计: 23380，耗时 0.11秒
2025-03-16 22:06:37,362 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:37,362 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:37,381 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:37,632 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:37,633 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:37,689 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:37,728 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:37,728 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:37,806 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:37,806 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:37,825 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:38,186 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:38,186 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:38,298 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:38,298 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:38,700 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:38,701 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:38,725 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:38,792 - config - INFO -   → 成功存储 552 个向量，总计: 23932，耗时 0.12秒
2025-03-16 22:06:38,792 - config - INFO -   → 成功存储 552 个向量，总计: 23932，耗时 0.12秒
2025-03-16 22:06:39,094 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:39,094 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:39,775 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:06:39,776 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:06:39,801 - config - INFO - ✅ 模型预热完成
2025-03-16 22:06:40,207 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:06:40,207 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:06:40,383 - config - INFO -   → 成功存储 555 个向量，总计: 24487，耗时 0.12秒
2025-03-16 22:06:40,383 - config - INFO -   → 成功存储 555 个向量，总计: 24487，耗时 0.12秒
2025-03-16 22:06:41,059 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:41,059 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:41,755 - config - INFO -   → 成功存储 557 个向量，总计: 25044，耗时 0.10秒
2025-03-16 22:06:41,755 - config - INFO -   → 成功存储 557 个向量，总计: 25044，耗时 0.10秒
2025-03-16 22:06:42,570 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:42,570 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:43,182 - config - INFO -   → 成功存储 555 个向量，总计: 25599，耗时 0.11秒
2025-03-16 22:06:43,182 - config - INFO -   → 成功存储 555 个向量，总计: 25599，耗时 0.11秒
2025-03-16 22:06:44,112 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:44,112 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:44,506 - config - INFO -   → 成功存储 550 个向量，总计: 26149，耗时 0.11秒
2025-03-16 22:06:44,506 - config - INFO -   → 成功存储 550 个向量，总计: 26149，耗时 0.11秒
2025-03-16 22:06:45,905 - config - INFO -   → 成功存储 564 个向量，总计: 26713，耗时 0.12秒
2025-03-16 22:06:45,905 - config - INFO -   → 成功存储 564 个向量，总计: 26713，耗时 0.12秒
2025-03-16 22:06:46,595 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:46,595 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:47,274 - config - INFO -   → 成功存储 551 个向量，总计: 27264，耗时 0.12秒
2025-03-16 22:06:47,274 - config - INFO -   → 成功存储 551 个向量，总计: 27264，耗时 0.12秒
2025-03-16 22:06:48,102 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:48,102 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:48,692 - config - INFO -   → 成功存储 558 个向量，总计: 27822，耗时 0.11秒
2025-03-16 22:06:48,692 - config - INFO -   → 成功存储 558 个向量，总计: 27822，耗时 0.11秒
2025-03-16 22:06:49,612 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:49,612 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:50,139 - config - INFO -   → 成功存储 560 个向量，总计: 28382，耗时 0.12秒
2025-03-16 22:06:50,139 - config - INFO -   → 成功存储 560 个向量，总计: 28382，耗时 0.12秒
2025-03-16 22:06:51,118 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:51,118 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:51,582 - config - INFO -   → 成功存储 553 个向量，总计: 28935，耗时 0.14秒
2025-03-16 22:06:51,582 - config - INFO -   → 成功存储 553 个向量，总计: 28935，耗时 0.14秒
2025-03-16 22:06:52,629 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:52,629 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:53,011 - config - INFO -   → 成功存储 562 个向量，总计: 29497，耗时 0.12秒
2025-03-16 22:06:53,011 - config - INFO -   → 成功存储 562 个向量，总计: 29497，耗时 0.12秒
2025-03-16 22:06:54,508 - config - INFO -   → 成功存储 549 个向量，总计: 30046，耗时 0.15秒
2025-03-16 22:06:54,508 - config - INFO -   → 成功存储 549 个向量，总计: 30046，耗时 0.15秒
2025-03-16 22:06:55,161 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:55,161 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:55,839 - config - INFO -   → 成功存储 557 个向量，总计: 30603，耗时 0.12秒
2025-03-16 22:06:55,839 - config - INFO -   → 成功存储 557 个向量，总计: 30603，耗时 0.12秒
2025-03-16 22:06:56,670 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:56,670 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:57,214 - config - INFO -   → 成功存储 559 个向量，总计: 31162，耗时 0.12秒
2025-03-16 22:06:57,214 - config - INFO -   → 成功存储 559 个向量，总计: 31162，耗时 0.12秒
2025-03-16 22:06:58,201 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:58,201 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:06:58,595 - config - INFO -   → 成功存储 558 个向量，总计: 31720，耗时 0.12秒
2025-03-16 22:06:58,595 - config - INFO -   → 成功存储 558 个向量，总计: 31720，耗时 0.12秒
2025-03-16 22:06:59,968 - config - INFO -   → 成功存储 553 个向量，总计: 32273，耗时 0.12秒
2025-03-16 22:06:59,968 - config - INFO -   → 成功存储 553 个向量，总计: 32273，耗时 0.12秒
2025-03-16 22:07:00,656 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:00,656 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:01,409 - config - INFO -   → 成功存储 560 个向量，总计: 32833，耗时 0.12秒
2025-03-16 22:07:01,409 - config - INFO -   → 成功存储 560 个向量，总计: 32833，耗时 0.12秒
2025-03-16 22:07:02,167 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:02,167 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:02,671 - config - INFO -   → 批次 3 文本切分完成，耗时 32.47秒
2025-03-16 22:07:02,671 - config - INFO -   → 批次 3 文本切分完成，耗时 32.47秒
2025-03-16 22:07:02,671 - config - INFO - 
分区进度: 已处理 30000 条记录 (6.0%)
2025-03-16 22:07:02,671 - config - INFO - 
分区进度: 已处理 30000 条记录 (6.0%)
2025-03-16 22:07:02,671 - config - INFO -   → 已用时间: 1.8分钟，预计剩余: 28.1分钟
2025-03-16 22:07:02,671 - config - INFO -   → 已用时间: 1.8分钟，预计剩余: 28.1分钟
2025-03-16 22:07:02,671 - config - INFO -   → 已生成 38444 个文本块，队列大小: 4553
2025-03-16 22:07:02,671 - config - INFO -   → 已生成 38444 个文本块，队列大小: 4553
2025-03-16 22:07:02,777 - config - INFO - 批次 4: 处理 10000 条记录
2025-03-16 22:07:02,777 - config - INFO - 批次 4: 处理 10000 条记录
2025-03-16 22:07:02,779 - config - INFO -   → 成功存储 546 个向量，总计: 33379，耗时 0.09秒
2025-03-16 22:07:02,779 - config - INFO -   → 成功存储 546 个向量，总计: 33379，耗时 0.09秒
2025-03-16 22:07:02,781 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,781 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,782 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,782 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,782 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,782 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,784 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,784 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,784 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,784 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,784 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,785 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,785 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,785 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,785 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,785 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,785 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,786 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,786 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,787 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,787 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:02,788 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:02,788 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:02,788 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:04,185 - config - INFO -   → 成功存储 557 个向量，总计: 33936，耗时 0.12秒
2025-03-16 22:07:04,185 - config - INFO -   → 成功存储 557 个向量，总计: 33936，耗时 0.12秒
2025-03-16 22:07:05,583 - config - INFO -   → 成功存储 556 个向量，总计: 34492，耗时 0.11秒
2025-03-16 22:07:05,583 - config - INFO -   → 成功存储 556 个向量，总计: 34492，耗时 0.11秒
2025-03-16 22:07:06,357 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:06,357 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:06,401 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:06,645 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:06,645 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:06,658 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:06,770 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:06,770 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:06,886 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:06,886 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:06,898 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:06,969 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:06,969 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:06,991 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:07,029 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:07,029 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:07,065 - config - INFO -   → 成功存储 561 个向量，总计: 35053，耗时 0.12秒
2025-03-16 22:07:07,065 - config - INFO -   → 成功存储 561 个向量，总计: 35053，耗时 0.12秒
2025-03-16 22:07:07,164 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:07,164 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:07,183 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:07,382 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:07,382 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:07,591 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:07,594 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:07,626 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:07,628 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:07,722 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:07,881 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:07,882 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:08,026 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:08,027 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:08,119 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:08,119 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:08,132 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:08,538 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:08,538 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:08,657 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:08,657 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:08,677 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:09,035 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:09,036 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:09,038 - config - INFO -   → 成功存储 553 个向量，总计: 35606，耗时 0.13秒
2025-03-16 22:07:09,038 - config - INFO -   → 成功存储 553 个向量，总计: 35606，耗时 0.13秒
2025-03-16 22:07:10,522 - config - INFO -   → 成功存储 545 个向量，总计: 36151，耗时 0.13秒
2025-03-16 22:07:10,522 - config - INFO -   → 成功存储 545 个向量，总计: 36151，耗时 0.13秒
2025-03-16 22:07:11,193 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:11,193 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:11,888 - config - INFO -   → 成功存储 556 个向量，总计: 36707，耗时 0.12秒
2025-03-16 22:07:11,888 - config - INFO -   → 成功存储 556 个向量，总计: 36707，耗时 0.12秒
2025-03-16 22:07:12,703 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:12,703 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:13,248 - config - INFO -   → 成功存储 561 个向量，总计: 37268，耗时 0.12秒
2025-03-16 22:07:13,248 - config - INFO -   → 成功存储 561 个向量，总计: 37268，耗时 0.12秒
2025-03-16 22:07:14,219 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:14,219 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:14,595 - config - INFO -   → 成功存储 549 个向量，总计: 37817，耗时 0.12秒
2025-03-16 22:07:14,595 - config - INFO -   → 成功存储 549 个向量，总计: 37817，耗时 0.12秒
2025-03-16 22:07:15,967 - config - INFO -   → 成功存储 533 个向量，总计: 38350，耗时 0.11秒
2025-03-16 22:07:15,967 - config - INFO -   → 成功存储 533 个向量，总计: 38350，耗时 0.11秒
2025-03-16 22:07:16,666 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:16,666 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:17,349 - config - INFO -   → 成功存储 540 个向量，总计: 38890，耗时 0.11秒
2025-03-16 22:07:17,349 - config - INFO -   → 成功存储 540 个向量，总计: 38890，耗时 0.11秒
2025-03-16 22:07:18,176 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:18,176 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:18,696 - config - INFO -   → 成功存储 565 个向量，总计: 39455，耗时 0.12秒
2025-03-16 22:07:18,696 - config - INFO -   → 成功存储 565 个向量，总计: 39455，耗时 0.12秒
2025-03-16 22:07:19,687 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:19,687 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4525 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4525 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75196, 批处理大小: 512
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75196, 批处理大小: 512
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4524 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4524 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75197, 批处理大小: 512
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75197, 批处理大小: 512
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4523 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 已处理 40000 个嵌入向量 (371.1 个/秒), 队列中还有 4523 个文本块
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75198, 批处理大小: 512
2025-03-16 22:07:19,803 - config - INFO -   → 缓存命中率: 3.4%, 命中/未命中: 2623/75198, 批处理大小: 512
2025-03-16 22:07:20,124 - config - INFO -   → 成功存储 554 个向量，总计: 40009，耗时 0.11秒
2025-03-16 22:07:20,124 - config - INFO -   → 成功存储 554 个向量，总计: 40009，耗时 0.11秒
2025-03-16 22:07:21,548 - config - INFO -   → 成功存储 561 个向量，总计: 40570，耗时 0.15秒
2025-03-16 22:07:21,548 - config - INFO -   → 成功存储 561 个向量，总计: 40570，耗时 0.15秒
2025-03-16 22:07:22,198 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:22,198 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:22,924 - config - INFO -   → 成功存储 565 个向量，总计: 41135，耗时 0.12秒
2025-03-16 22:07:22,924 - config - INFO -   → 成功存储 565 个向量，总计: 41135，耗时 0.12秒
2025-03-16 22:07:23,705 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:23,705 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:24,317 - config - INFO -   → 成功存储 568 个向量，总计: 41703，耗时 0.12秒
2025-03-16 22:07:24,317 - config - INFO -   → 成功存储 568 个向量，总计: 41703，耗时 0.12秒
2025-03-16 22:07:25,217 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:25,217 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:25,713 - config - INFO -   → 成功存储 580 个向量，总计: 42283，耗时 0.12秒
2025-03-16 22:07:25,713 - config - INFO -   → 成功存储 580 个向量，总计: 42283，耗时 0.12秒
2025-03-16 22:07:27,059 - config - INFO - 进度检查: 3/3 个线程活跃
2025-03-16 22:07:27,059 - config - INFO - 进度检查: 3/3 个线程活跃
2025-03-16 22:07:27,059 - config - INFO - 块队列大小: 5000, 结果队列大小: 0
2025-03-16 22:07:27,059 - config - INFO - 块队列大小: 5000, 结果队列大小: 0
2025-03-16 22:07:27,059 - config - INFO - 切分完成标志: False, 嵌入完成标志: False
2025-03-16 22:07:27,059 - config - INFO - 切分完成标志: False, 嵌入完成标志: False
2025-03-16 22:07:27,074 - config - INFO -   → 成功存储 580 个向量，总计: 42863，耗时 0.12秒
2025-03-16 22:07:27,074 - config - INFO -   → 成功存储 580 个向量，总计: 42863，耗时 0.12秒
2025-03-16 22:07:27,752 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:27,752 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:28,514 - config - INFO -   → 成功存储 593 个向量，总计: 43456，耗时 0.12秒
2025-03-16 22:07:28,514 - config - INFO -   → 成功存储 593 个向量，总计: 43456，耗时 0.12秒
2025-03-16 22:07:29,269 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:29,269 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:29,597 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4757 个文本块
2025-03-16 22:07:29,597 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4757 个文本块
2025-03-16 22:07:29,597 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82133, 批处理大小: 512
2025-03-16 22:07:29,597 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82133, 批处理大小: 512
2025-03-16 22:07:29,598 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4756 个文本块
2025-03-16 22:07:29,598 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4756 个文本块
2025-03-16 22:07:29,598 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82134, 批处理大小: 512
2025-03-16 22:07:29,598 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82134, 批处理大小: 512
2025-03-16 22:07:29,598 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4755 个文本块
2025-03-16 22:07:29,598 - config - INFO -   → 已处理 44000 个嵌入向量 (374.2 个/秒), 队列中还有 4755 个文本块
2025-03-16 22:07:29,598 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82135, 批处理大小: 512
2025-03-16 22:07:29,598 - config - INFO -   → 缓存命中率: 3.6%, 命中/未命中: 3039/82135, 批处理大小: 512
2025-03-16 22:07:29,944 - config - INFO -   → 成功存储 584 个向量，总计: 44040，耗时 0.12秒
2025-03-16 22:07:29,944 - config - INFO -   → 成功存储 584 个向量，总计: 44040，耗时 0.12秒
2025-03-16 22:07:30,779 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:30,779 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:31,276 - config - INFO -   → 成功存储 590 个向量，总计: 44630，耗时 0.12秒
2025-03-16 22:07:31,276 - config - INFO -   → 成功存储 590 个向量，总计: 44630，耗时 0.12秒
2025-03-16 22:07:32,300 - config - INFO -   → 批次 4 文本切分完成，耗时 29.52秒
2025-03-16 22:07:32,300 - config - INFO -   → 批次 4 文本切分完成，耗时 29.52秒
2025-03-16 22:07:32,301 - config - INFO - 
分区进度: 已处理 40000 条记录 (8.0%)
2025-03-16 22:07:32,301 - config - INFO - 
分区进度: 已处理 40000 条记录 (8.0%)
2025-03-16 22:07:32,301 - config - INFO -   → 已用时间: 2.3分钟，预计剩余: 26.3分钟
2025-03-16 22:07:32,301 - config - INFO -   → 已用时间: 2.3分钟，预计剩余: 26.3分钟
2025-03-16 22:07:32,301 - config - INFO -   → 已生成 50580 个文本块，队列大小: 4991
2025-03-16 22:07:32,301 - config - INFO -   → 已生成 50580 个文本块，队列大小: 4991
2025-03-16 22:07:32,403 - config - INFO - 批次 5: 处理 10000 条记录
2025-03-16 22:07:32,403 - config - INFO - 批次 5: 处理 10000 条记录
2025-03-16 22:07:32,406 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,406 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,407 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,407 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,407 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,408 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,408 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,408 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,409 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,410 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,410 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,410 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,411 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,411 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,412 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,412 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,413 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,413 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,413 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,413 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,414 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,414 - config - INFO - 正在加载模型到 mps 设备...
2025-03-16 22:07:32,414 - config - INFO - 正在优化加载模型到 mps 设备...
2025-03-16 22:07:32,415 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:32,636 - config - INFO -   → 成功存储 575 个向量，总计: 45205，耗时 0.12秒
2025-03-16 22:07:32,636 - config - INFO -   → 成功存储 575 个向量，总计: 45205，耗时 0.12秒
2025-03-16 22:07:34,075 - config - INFO -   → 成功存储 563 个向量，总计: 45768，耗时 0.12秒
2025-03-16 22:07:34,075 - config - INFO -   → 成功存储 563 个向量，总计: 45768，耗时 0.12秒
2025-03-16 22:07:35,450 - config - INFO -   → 成功存储 589 个向量，总计: 46357，耗时 0.16秒
2025-03-16 22:07:35,450 - config - INFO -   → 成功存储 589 个向量，总计: 46357，耗时 0.16秒
2025-03-16 22:07:36,298 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:36,298 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:36,324 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:36,539 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:36,539 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:36,563 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:36,694 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:36,695 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:36,892 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:36,892 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:36,912 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:36,925 - config - INFO -   → 成功存储 607 个向量，总计: 46964，耗时 0.13秒
2025-03-16 22:07:36,925 - config - INFO -   → 成功存储 607 个向量，总计: 46964，耗时 0.13秒
2025-03-16 22:07:37,103 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:37,105 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:37,363 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:37,363 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:37,980 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:37,983 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:38,108 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:38,219 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:38,220 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:38,315 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:38,316 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:38,340 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:38,341 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:38,342 - config - INFO - ✅ 成功加载模型: sentence-transformers/all-MiniLM-L6-v2
2025-03-16 22:07:38,342 - config - INFO - ✅ 模型成功加载到 MPS 设备
2025-03-16 22:07:38,354 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:38,368 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:38,382 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:38,382 - config - INFO - ✅ 模型预热完成
2025-03-16 22:07:38,519 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:38,519 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:38,783 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:38,784 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:38,791 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:38,791 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:38,793 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:38,793 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:38,849 - config - INFO -   → 成功存储 618 个向量，总计: 47582，耗时 0.19秒
2025-03-16 22:07:38,849 - config - INFO -   → 成功存储 618 个向量，总计: 47582，耗时 0.19秒
2025-03-16 22:07:39,172 - config - INFO - ✅ 成功加载对应 tokenizer
2025-03-16 22:07:39,172 - config - INFO - 模型加载完成，使用的设备: mps:0
2025-03-16 22:07:40,444 - config - INFO -   → 成功存储 602 个向量，总计: 48184，耗时 0.19秒
2025-03-16 22:07:40,444 - config - INFO -   → 成功存储 602 个向量，总计: 48184，耗时 0.19秒
2025-03-16 22:07:41,490 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:41,490 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:41,878 - config - INFO -   → 成功存储 602 个向量，总计: 48786，耗时 0.13秒
2025-03-16 22:07:41,878 - config - INFO -   → 成功存储 602 个向量，总计: 48786，耗时 0.13秒
2025-03-16 22:07:43,306 - config - INFO -   → 成功存储 595 个向量，总计: 49381，耗时 0.12秒
2025-03-16 22:07:43,306 - config - INFO -   → 成功存储 595 个向量，总计: 49381，耗时 0.12秒
2025-03-16 22:07:43,980 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:43,980 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:44,743 - config - INFO -   → 成功存储 583 个向量，总计: 49964，耗时 0.13秒
2025-03-16 22:07:44,743 - config - INFO -   → 成功存储 583 个向量，总计: 49964，耗时 0.13秒
2025-03-16 22:07:45,490 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:45,490 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:46,135 - config - INFO -   → 成功存储 584 个向量，总计: 50548，耗时 0.13秒
2025-03-16 22:07:46,135 - config - INFO -   → 成功存储 584 个向量，总计: 50548，耗时 0.13秒
2025-03-16 22:07:47,001 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:47,001 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:47,558 - config - INFO -   → 成功存储 589 个向量，总计: 51137，耗时 0.13秒
2025-03-16 22:07:47,558 - config - INFO -   → 成功存储 589 个向量，总计: 51137，耗时 0.13秒
2025-03-16 22:07:48,510 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:48,510 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:49,015 - config - INFO -   → 成功存储 613 个向量，总计: 51750，耗时 0.13秒
2025-03-16 22:07:49,015 - config - INFO -   → 成功存储 613 个向量，总计: 51750，耗时 0.13秒
2025-03-16 22:07:50,026 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:50,026 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:50,405 - config - INFO -   → 成功存储 600 个向量，总计: 52350，耗时 0.12秒
2025-03-16 22:07:50,405 - config - INFO -   → 成功存储 600 个向量，总计: 52350，耗时 0.12秒
2025-03-16 22:07:51,744 - config - INFO -   → 成功存储 598 个向量，总计: 52948，耗时 0.13秒
2025-03-16 22:07:51,744 - config - INFO -   → 成功存储 598 个向量，总计: 52948，耗时 0.13秒
2025-03-16 22:07:52,419 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:52,419 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:53,212 - config - INFO -   → 成功存储 593 个向量，总计: 53541，耗时 0.12秒
2025-03-16 22:07:53,212 - config - INFO -   → 成功存储 593 个向量，总计: 53541，耗时 0.12秒
2025-03-16 22:07:53,925 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:53,925 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:54,554 - config - INFO -   → 成功存储 617 个向量，总计: 54158，耗时 0.13秒
2025-03-16 22:07:54,554 - config - INFO -   → 成功存储 617 个向量，总计: 54158，耗时 0.13秒
2025-03-16 22:07:55,442 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:55,442 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:55,904 - config - INFO -   → 成功存储 589 个向量，总计: 54747，耗时 0.12秒
2025-03-16 22:07:55,904 - config - INFO -   → 成功存储 589 个向量，总计: 54747，耗时 0.12秒
2025-03-16 22:07:57,315 - config - INFO -   → 成功存储 601 个向量，总计: 55348，耗时 0.14秒
2025-03-16 22:07:57,315 - config - INFO -   → 成功存储 601 个向量，总计: 55348，耗时 0.14秒
2025-03-16 22:07:57,973 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
2025-03-16 22:07:57,973 - config - WARNING - 块队列已满 (5000/5000)，等待空间...
